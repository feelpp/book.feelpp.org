<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Time adaptation strategy for incompressible Navier Stokes equations and convection-diffusion equations :: Feel++ Docs</title>
    <link rel="canonical" href="https://docs.feelpp.org/dev/latest/reference/Time/adaptivestepping.html">
    <link rel="prev" href="bdf.html">
    <link rel="next" href="../exporter.html">
    <meta name="generator" content="Antora 3.1.2">
    <link rel="stylesheet" href="../../../../_/css/site.css">
<link rel="icon" href="../../../../_/img/favicon.ico" type="image/x-icon">    
<script>!function(l,p){if(l.protocol!==p&&l.host=="docs.antora.org"){l.protocol=p}else if(/\.gitlab\.io$/.test(l.host)){l.replace(p+"//docs.antora.org"+l.pathname.substr(l.pathname.indexOf("/",1))+l.search+l.hash)}}(location,"https:")</script>

<script src="../../../../_/js/vendor/tabs-block-extension.js"></script>
<script src="../../../../_/js/vendor/tabs-block-behavior.js"></script>




<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  messageStyle: "none",
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$'], ['\\[','\\]']],
    processEscapes: true,
    processEnvironments: true, 
    ignoreClass: "nostem|nolatexmath"
  },
  asciimath2jax: {
    delimiters: [["\\$", "\\$"]],
    ignoreClass: "nostem|noasciimath"
  },

  TeX: {
      Macros: {
      RR: "{\\mathbb R}",
      NN: "{\\mathbb N}",
      Nso: "{N_{\\mathrm{so}}}",
      Nma: "{N_{\\mathrm{ma}}}",
      Nno: "{N_{\\mathrm{no}}}",
      Ne: "{N_{\\mathrm{e}}}",
      Ilag: ["{\\mathcal{I}^{\\mathrm{lag}}_{#1}}",1],
      calTh: "{\\mathcal{T}_h}",
      Ck: ["{\\mathcal{C}^{#1}}",1],
      Pk: ["{\\mathcal{P}^{#1}}",1],
      Qk: ["{\\mathcal{Q}^{#1}}",1],
      Pch: ["{P^{#1}_{c,h}}",1],
      Pcho: ["{P^{#1}_{c,h,0}}",1],
      Qch: ["{Q^{#1}_{c,h}}",1],
      Ich: ["{\\mathcal{I}^{#1}_{c,h}#2}",2],
      poly: ["{\\mathbb{#1}}",1],
      nf: "{n_f}",
      ngeo: "{n_{\\mathrm{geo}}}",
      geo: "{\\mathrm{geo}}",
      card: ["{\\operatorname{card}(#1)}",1],
      dim: ["{\\operatorname{dim}(#1)}",1],
      opdim: "{\\operatorname{dim}}",
      card: ["{\\operatorname{card}(#1)}",1],
      poly: ["{\\mathbb{#1}",1],
      R: ["{\\mathbb{R}^{#1}}",1],
      set: ["{\\left\\{#1\\right\\}}",1],
      diam: "{\\operatorname{diam}}",
      jump: ["{[\\![ #1 ]\\!]}",1],
      Next: "{\\mathrm{n}}",
      essinf: "{\\operatorname{ess}\\, \\operatorname{inf}}",
      tr: "{\\operatorname{tr}}",
      Id: "{\\mathcal{I}}",
      disp: ["{\\mathbf{#1}}",1],
      stresst: ["{\\mathbf{\\sigma(#1)}}",1],
      deformt: ["{\\mathbf{\\varepsilon(#1)}}",1],
      domain: "{\\Omega}",
      prect: ["{\\left\\(#1\\right\\)}",1],
      ds: "",
      bold: ["{\\bf #1}",1],
      p: "{\\mathrm{p}}",
      q:"{\\mathbf{q}}",
      n:"{\\mathbf{n}}",
      T:"{\\mathcal{T}}",
      F:"{\\mathcal{F}}",
      P:"{\\mathcal{P}}",
      v:"{\\mathbf{v}}"
  },
  extensions: ["mhchem.js"] }
});
</script>
<!--<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/MathJax.js?config=TeX-MML-AM_CHTML"></script>-->
<!-- <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML' async></script> -->
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_CHTML'>
</script>
<!--<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.6.0/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script>-->

<!--<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0/katex.min.css" integrity="sha384-TEMocfGvRuD1rIAacqrknm5BQZ7W7uWitoih+jMNFXQIbNl16bO8OZmylH/Vi/Ei" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0/katex.min.js" integrity="sha384-jmxIlussZWB7qCuB+PgKG1uLjjxbVVIayPJwi6cG6Zb4YKq0JIw+OMnkkEC7kYCq" crossorigin="anonymous"></script>-->

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-65761593-1"></script>
<script>function gtag(){dataLayer.push(arguments)};window.dataLayer=window.dataLayer||[];gtag('js',new Date());gtag('config','UA-65761593-1')</script>
<script>var uiRootPath = '../../../../_'</script>

<script type='text/javascript' src='https://platform-api.sharethis.com/js/sharethis.js#property=5f34e90f94876f0012457ea1&product=sop' async='async'></script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar  navbar-expand-sm bg-dark navbar-dark">
    <div class="navbar-brand">
      <div class="navbar-item">
         <!--  <a href="https://book.feelpp.org">Feel++ documentation</a> -->
           <a href="https://docs.feelpp.org">Feel++ Docs</a>
      </div>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://docs.feelpp.org">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <div class="navbar-link">Docs</div>
          <div class="navbar-dropdown">
            <div class="navbar-item"><strong>Latest Version</strong></div>

            <!-- this code allow to manage ordering of navbar item -->
                                                                                                                                      

            <hr class="navbar-divider">
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <div class="navbar-link">Feel++</div>
          <div class="navbar-dropdown">
            <div class="navbar-item"><strong>GitHub</strong></div>
            <a class="navbar-item" href="http://github.com/feelpp/feelpp">GitHub Repository</a>
            <a class="navbar-item" href="http://github.com/feelpp/feelpp/issues">GitHub Issue Tracker</a>
            <hr class="navbar-divider">
            <div class="navbar-item"><strong>Documentation</strong></div>
            <a class="navbar-item" href="http://docs.feelpp.org/user/">User Manual</a>
            <a class="navbar-item" href="http://docs.feelpp.org/dev/">Developer Manual</a>
            <a class="navbar-item" href="http://docs.feelpp.org/toolbox/">Toolbox Manual</a>
            
          </div>
        </div>
        <div class="primary-action">
            <form class="navbar-item search">
              <input type="text" placeholder="Search Feel++ Docs" class="query" id="search-query">
              <button type="button" class="search-btn"><i class="fas fa-search"></i></button>
            </form>
        </div>
        <div class="navbar-item">
          <a class="navbar-brand" href="https://join.slack.com/t/feelpp/shared_invite/zt-2qe0q9hw-4pVbhohCXUE6Po9Ma8dbiQ">
            <img src="../../../../_/img/slack.png" alt="slack" style="width:30px;"></a>
        </div>
        <div class="navbar-item">
          <a class="navbar-brand"  href="http://docs.feelpp.org">
            <img src="../../../../_/img/logoFeelpp.png" alt="Feel++" style="width:60px;">
          </a>
        </div>
        <div class="navbar-item">
          <a class="navbar-brand"  href="http://www.cemosis.fr">
            <img src="../../../../_/img/logoCemosisTransparent.png" alt="Cemosis" style="width:60px;">
          </a>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="dev" data-version="0.110">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../../index.html">Developer manual</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Programming with Feel++</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Programming environment</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <span class="nav-text">Debugging Feel++</span>
  </li>
  <li class="nav-item" data-depth="2">
    <span class="nav-text">Profiling Feel++</span>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../../tutorial-dev/latest/index.html">Feel++ Development Tutorial</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../../template_project/1.0.3/index.html">Feel++ Template Project</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../index.html">Mathematical Concepts Reference</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../Mesh/README.html">Mesh</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Mesh/iterators.html">Mesh iterators</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../Integrals/README.html">Integrals</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Integrals/integrate.html">integrate</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Integrals/mean.html">mean</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Integrals/norms.html">norms</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Integrals/project.html">project</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../Spaces/README.html">Function spaces</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Spaces/notations.html">Notations</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Spaces/functionspace.html">FunctionSpace</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Spaces/projection.html">Projection</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Spaces/interpolation.html">Interpolation</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Spaces/save.html">Save</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../Solver/README.html">Algebraic solutions</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Solver/notations.html">Notations</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Solver/backend.html">Defining a backend</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Solver/preconditioner.html">Defining a preconditioner</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Solver/solving.html">Solving linear systems</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../Solver/eigensolver.html">Solving eigenvalue problems</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../forms.html">Linear and Bilinear Forms</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="README.html">Time Discretization</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="bdf.html">BDF</a>
  </li>
  <li class="nav-item is-current-page" data-depth="3">
    <a class="nav-link" href="adaptivestepping.html">Adaptive time stepping</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../exporter.html">Post-processing and Visualization</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../Keywords/README.html">Mathematical keywords</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Developer Reference</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../cmake.html">CMake Feel++ macros</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../environment.html">Feel++ Environment</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../fileformats.html">Feel++ File Formats</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../codingrules.html">Feel++ Coding Rules</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Developer manual</span>
    <span class="version">0.110</span>
  </div>
  <ul class="components">
    <li class="component">
      <a class="title" href="../../../../angiotk/0.1/index.html">AngioTK User Manual</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../angiotk/0.1/index.html">0.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../data/latest/index.html">Data Manual</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../data/latest/index.html">latest</a>
        </li>
        <li class="version">
          <a href="../../../../data/0.110/index.html">0.110</a>
        </li>
        <li class="version">
          <a href="../../../../data/0.109/index.html">0.109</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <a class="title" href="../../../latest/index.html">Developer manual</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../latest/index.html">latest</a>
        </li>
        <li class="version is-current">
          <a href="../../index.html">0.110</a>
        </li>
        <li class="version">
          <a href="../../../0.109/index.html">0.109</a>
        </li>
        <li class="version">
          <a href="../../../0.108/index.html">0.108</a>
        </li>
        <li class="version">
          <a href="../../../0.107/index.html">0.107</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../salome/current/index.html">Feel++ and Salome</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../salome/current/index.html">current</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../feelpp/latest/index.html">Feel++ Documentation</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../feelpp/latest/index.html">latest</a>
        </li>
        <li class="version">
          <a href="../../../../feelpp/0.110/index.html">0.110</a>
        </li>
        <li class="version">
          <a href="../../../../feelpp/0.109/index.html">0.109</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../math/index.html">Feel++ Mathematics</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../math/index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../template_project/1.0.3/index.html">Feel++ Templace Project</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../template_project/1.0.3/index.html">1.0.3</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../cases/latest/index.html">Feel++ Toolbox Cases Guide</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../cases/latest/index.html">latest</a>
        </li>
        <li class="version">
          <a href="../../../../cases/0.110/index.html">0.110</a>
        </li>
        <li class="version">
          <a href="../../../../cases/0.109/index.html">0.109</a>
        </li>
        <li class="version">
          <a href="../../../../cases/0.108/index.html">0.108</a>
        </li>
        <li class="version">
          <a href="../../../../cases/0.107/index.html">0.107</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../toolboxes/latest/index.html">Feel++ Toolboxes Manual</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../toolboxes/latest/index.html">latest</a>
        </li>
        <li class="version">
          <a href="../../../../toolboxes/0.110/index.html">0.110</a>
        </li>
        <li class="version">
          <a href="../../../../toolboxes/0.109/index.html">0.109</a>
        </li>
        <li class="version">
          <a href="../../../../toolboxes/0.108/index.html">0.108</a>
        </li>
        <li class="version">
          <a href="../../../../toolboxes/0.107/index.html">0.107</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../tutorial-dev/latest/index.html">Feel++ Tutorial Dev</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../tutorial-dev/latest/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../user/latest/index.html">Feel++ User Manual</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../user/latest/index.html">latest</a>
        </li>
        <li class="version">
          <a href="../../../../user/0.110/index.html">0.110</a>
        </li>
        <li class="version">
          <a href="../../../../user/0.109/index.html">0.109</a>
        </li>
        <li class="version">
          <a href="../../../../user/0.108/index.html">0.108</a>
        </li>
        <li class="version">
          <a href="../../../../user/0.107/index.html">0.107</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../mor/latest/index.html">Model Order Reduction</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../mor/latest/index.html">latest</a>
        </li>
        <li class="version">
          <a href="../../../../mor/0.110/index.html">0.110</a>
        </li>
        <li class="version">
          <a href="../../../../mor/0.109/index.html">0.109</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../contribute/index.html">Toolbox Contribution Guide</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../contribute/index.html">master</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../../../feelpp/0.110/index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../index.html">Developer manual</a></li>
    <li><a href="../index.html">Mathematical Concepts Reference</a></li>
    <li><a href="README.html">Time Discretization</a></li>
    <li><a href="adaptivestepping.html">Adaptive time stepping</a></li>
  </ul>
</nav>

<div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">0.110</button>
  <div class="version-menu">
    <a class="version" href="../../../latest/reference/Time/adaptivestepping.html">latest</a>
    <a class="version is-current" href="adaptivestepping.html">0.110</a>
    <a class="version" href="../../../0.109/reference/Time/adaptivestepping.html">0.109</a>
    <a class="version" href="../../../0.108/reference/Time/adaptivestepping.html">0.108</a>
    <a class="version" href="../../../0.107/reference/Time/adaptivestepping.html">0.107</a>
  </div>
</div>
  
<div class="dropdown">
  <button class="dropbtn" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <div class="dropdown-content">


          <a onclick="print(this)"  class="headerbtn"  data-toggle="tooltip" data-placement="left" title="Print to PDF">
              .pdf <i class="fas fa-file-pdf"></i>
          </a>

  </div>
</div>
  
<div class="dropdown">
  <button class="dropbtn" aria-label="Github">
    <i class="fab fa-github"></i>
  </button>
  <div class="dropdown-content">

    <a href="https://github.com/feelpp/book.feelpp.org">Open repository <i class="fab fa-github"></i></a>
    
  <a href="https://github.com/feelpp/book.feelpp.org/blob/v0.110/docs/dev/modules/reference/pages/Time/adaptivestepping.adoc">Edit this Page <i class="fas fa-edit"></i></a>

    <a href="https://github.com/feelpp/book.feelpp.org/issues/new">Open issue <i class="fas fa-lightbulb"></i></a>


  </div>
</div>


<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>
</div>

  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>

<article class="doc">
<h1 class="page">Time adaptation strategy for incompressible Navier Stokes equations and convection-diffusion equations</h1>
<div id="preamble">
<div class="sectionbody">
<div id="toc" class="toc">
<div id="toctitle" class="title">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_notations">1. Notations</a></li>
<li><a href="#_convection_diffusion_equation">2. Convection-Diffusion equation</a></li>
<li><a href="#_navier_stokes_equations">3. Navier-Stokes equations</a></li>
</ul>
</div>
<div class="paragraph">
<p>The following strategy, proposed in <a href="#kay">[kay]</a>, can be adapted to any first order in time PDE. We focus here on the Convection-Diffusion equation and the Navier-Stokes equations to illustrate the scheme.</p>
</div>
<div class="paragraph">
<p>The strategy is 2nd order : it is based on the Crank-Nicolson (CN) implicit scheme coupled with the Adam-Bashforth order 2 (AB2) explicit scheme to adapt time steps. The particularity is that the scheme works with the discrete rate of change of the field of interest rather than the field itself in order to get a more accurate/stable and adaptive scheme, see <a href="#kay">[kay]</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_notations"><a class="anchor" href="#_notations"></a>1. Notations</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Denote \(\Omega \subset \mathbb{R}^d, d=1,2,3\) the computation domain and \(\partial \Omega\) its boundary. \(\partial \Omega = \partial \Omega_D \cup \partial \Omega_N \) which correspond to the Dirichlet and Neumann boundaries</p>
</div>
<div class="paragraph">
<p>We wish to solve equations on the time interval \([0,T\)] divided into \(N\) intervals, we denote \(\{t_n\}_{n=1,\ldots,N}\) the interval discretisation points and \(\{k_n\}_{n=2,\ldots,N}\) the time steps. We have \(k_{n+1}=t_{n+1}-t_{n}\).</p>
</div>
<div class="ulist">
<ul>
<li>
<p>\(\mathbf{n}\): the unit outward normal to \(\partial \Omega\)</p>
</li>
<li>
<p>\((\cdot,\cdot)\) : the \(L^2\) scalar product in \(\Omega\)</p>
</li>
<li>
<p>\((\cdot,\cdot)_{\partial \Omega}\) : the \(L^2\) scalar product on \(\partial \Omega\)</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_convection_diffusion_equation"><a class="anchor" href="#_convection_diffusion_equation"></a>2. Convection-Diffusion equation</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_navier_stokes_equations"><a class="anchor" href="#_navier_stokes_equations"></a>3. Navier-Stokes equations</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Denote</p>
</div>
<div class="ulist">
<ul>
<li>
<p>\(\mu\) : dynamic viscosity [SI \(Pa.s = kg/(s.m)\)]</p>
</li>
<li>
<p>\(\rho\) : density [SI \(kg/m^3\)]</p>
</li>
<li>
<p>\(\mathbf{f}\) the volumic force density</p>
</li>
<li>
<p>\(\mathbf{u}\) the velocity</p>
</li>
<li>
<p>\(p\) the pressure</p>
</li>
<li>
<p>\(D(\mathbf{u})=\frac{1}{2}\left(\nabla \mathbf{u}+\nabla \mathbf{u}^T\right)\) the deformation tensor.</p>
</li>
<li>
<p>\(\sigma(\mathbf{u},p)=-p I + 2\mu D(\mathbf{u})\) the newtonian stress tensor</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We consider the Navier-Stokes equations, namely find \((\mathbf{u},p)\) such that</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{split}
\rho \left( \frac{\partial \mathbf{u}}{\partial t} + \mathbf{u} \cdot \nabla \mathbf{u} \right) - \mu \nabla^2 \mathbf{u} + \nabla p = \mathbf{f}\ \text{ and } \nabla \cdot \mathbf{u} = 0
\end{split}\]
</div>
</div>
<div class="paragraph">
<p>completed with Dirichlet and Neumann boundary conditions</p>
</div>
<div class="stemblock">
<div class="content">
\[\sigma(\mathbf{u},p)\cdot \mathbf{n} = \mathbf{g}_N \text{ on } \partial \Omega_N, \quad \mathbf{u} = \mathbf{g}_D \text{ on } \partial \Omega_D\]
</div>
</div>
<div class="paragraph">
<p>We denote \((\mathbf{u}^n,p^n, \mathbf{d}^n)\) the velocity, pressure and discrete acceleration at time \(n\).
We start by writing the NS equations using the CN scheme.
We first extrapolate the convection velocity using a 2nd order formula</p>
</div>
<div class="stemblock">
<div class="content">
\[\mathbf{w}^{n+1} = \left(1+\frac{k_{n+1}}{k_n}\right)\mathbf{u}^n-\frac{k_{n+1}}{k_n} \mathbf{u}^{n-1}\]
</div>
</div>
<div class="paragraph">
<p>then we find \((\mathbf{u}^{n+1},p^{n+1})\) such that for all \((\mathbf{v},q)\) :</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{split}
(2 \rho \mathbf{u}^{n+1}/k_{n+1},v) + ( \mu \nabla \mathbf{u}^{n+1}, \nabla v)  + ( \rho  \mathbf{w}^{n+1} \cdot \nabla \mathbf{u}^{n+1} , v)  \\
- ( p^{n+1}, \nabla \cdot v )  - (  \nabla \cdot \mathbf{u}^{n+1}, q ) + \\ ( \sigma(\mathbf{u}^{n+1}, p^{n+1}) \cdot \mathbf{n},v)_{\partial \Omega} = (2\rho \mathbf{u}^{n}/k_{n+1},v) + (\frac{\partial \mathbf{u}^n}{\partial t}, v) +( \mathbf{f}, v)
\end{split}\]
</div>
</div>
<div class="paragraph">
<p>where :</p>
</div>
<div class="stemblock">
<div class="content">
\[\frac{\partial \mathbf{u}^n}{\partial t}:=\mu \Delta \mathbf{u}^n - \mathbf{u}^n\cdot \nabla \mathbf{u}^n - \nabla p^n\]
</div>
</div>
<div class="paragraph">
<p>which reads :</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{split}
(2 \rho \mathbf{u}^{n+1}/k_{n+1},v) + ( \mu \nabla \mathbf{u}^{n+1}, \nabla v)+
 ( \rho  \mathbf{w}^{n+1} \cdot \nabla \mathbf{u}^{n+1} , v) - ( p^{n+1}, \nabla \cdot v )  -  \\
 (  \nabla \cdot \mathbf{u}^{n+1}, q )  = (2\rho \mathbf{u}^{n}/k_{n+1},v) + (\frac{\partial \mathbf{u}^n}{\partial t}, v) +( f, v) + (\mathbf{g}^{n+1},v).
 \end{split}\]
</div>
</div>
<div class="paragraph">
<p>We rewrite the previous problem with the discrete acceleration</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{array}{rl}
\mathbf{d}^n &amp;=\frac{\mathbf{u}^{n+1}-\mathbf{u}^n}{k_{n+1}},\\
\mathbf{u}^{n+1} &amp;= \mathbf{u}^n+k_{n+1} \mathbf{d}^n.
\end{array}\]
</div>
</div>
<div class="paragraph">
<p>It reads :</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{split}
(\rho k_{n+1} \mathbf{d}^{n}/k_{n+1},v) + ( \mu \nabla k_{n+1} \mathbf{d}^{n}, \nabla v)  +  ( \rho k_{n+1}  \mathbf{w}^{n+1} \cdot \nabla \mathbf{d}^{n} , v) - \\
 ( p^{n+1}, \nabla \cdot v )  - (  k_{n+1} \nabla \cdot \mathbf{d}^{n}, q ) =\\
 - ( \mu \nabla u^{n}, \nabla v)  - ( \rho   \mathbf{w}^{n+1} \cdot \nabla u^{n} , v) +
  (\frac{\partial \mathbf{u}^n}{\partial t}, v) +( f, v) + (g^{n+1},v)_{\partial \Omega} + (\nabla \cdot \mathbf{u}^n, q).
\end{split}\]
</div>
</div>
<div class="paragraph">
<p>Once \(\mathbf{d}^n\) is computed, we update \(\mathbf{u}^{n+1}\) and \(\frac{\partial \mathbf{u}^{n+1}}{\partial t}\) as follows :</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{array}{rl}
\mathbf{u}^{n+1} &amp;= \mathbf{u}^n+k_{n+1} \mathbf{d}^n\\
\frac{\partial \mathbf{u}^{n+1}}{\partial t} &amp;= 2\mathbf{d}^n - \frac{\partial \mathbf{u}^{n}}{\partial t}.
\end{array}\]
</div>
</div>
<div class="paragraph">
<p>Then using the second order Adams-Baschforth scheme :</p>
</div>
<div class="stemblock">
<div class="content">
\[\mathbf{u}^{n+1}_{AB2} = \mathbf{u}^n + \frac{k_{n+1}}{2} \left[ (1+k_{n+1}/k_n)\frac{\partial \mathbf{u}^{n}}{\partial t} + \frac{k_{n+1}}{k_n}\frac{\partial \mathbf{u}^{n-1}}{\partial t}\right].\]
</div>
</div>
<div class="paragraph">
<p>We compute the error between \(\mathbf{u}^{n+1}\) and \(\mathbf{u}^{n+1}_{AB2}\) :</p>
</div>
<div class="stemblock">
<div class="content">
\[e^{n+1} = \frac{||\mathbf{u}^{n+1}-\mathbf{u}^{n+1}_{AB2}||}{3 (1+k_{n+1}/k_n)},\]
</div>
</div>
<div class="paragraph">
<p>that is used to adjust the time step :</p>
</div>
<div class="stemblock">
<div class="content">
\[k_{n+2}=k_{n+1} \left( \frac{\varepsilon}{e^{n+1}} \right)^{1/3}.\]
</div>
</div>
<div class="paragraph">
<p>Features:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>easily adapted to convection-diffusion equations, solid mechanics (introduce velocity as an auxiliary field),</p>
</li>
<li>
<p>simple decision per time step to select or not \(k_{n+2}\), simply reject \(k_{n+2}\) if \(e^{n+1} &gt; \alpha \varepsilon\) with \(\alpha &lt; 1\) (in the code \(\alpha=0.7\) and re-run current step \(n+1\) with small time-step :</p>
</li>
</ul>
</div>
<div class="stemblock">
<div class="content">
\[ k_{n+1}=k_{n+1}\left( \frac{\varepsilon}{e^{n+1}} \right)^{1/3}\]
</div>
</div>
<div class="paragraph">
<p>Issues:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>starting this algorithm and initial time step, see <a href="#kay">[kay]</a>,</p>
</li>
<li>
<p>the ringing effect which prohibits large time steps (or cancellation due to change of sign of the acceleration): averaging every \(n^*\) iterations.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>In order to fix the ringing effect, select a frequency \(n^*\) at which velocity and acceleration are averaged as follows:
save at \(t^*=t_n\), \(\mathbf{u}^*=\mathbf{u}^n\), \(k^*=\frac{k_n}{2}\), and do at \(t=t_n\)</p>
</div>
<div class="stemblock">
<div class="content">
\[t_n = t_n+k^*,\quad k_n=k^*,\quad \mathbf{u}^n=\frac{1}{2}\left(\mathbf{u}^*+\mathbf{u}^{n-1}\right),\quad \frac{\partial \mathbf{u}^n}{\partial t}=\frac{1}{2}\left(\frac{\partial \mathbf{u}^n}{\partial t}+\frac{\partial \mathbf{u}^{n-1}}{\partial t}\right)\]
</div>
</div>
<div class="paragraph">
<p>and at
\(t=t_{n+1}\)</p>
</div>
<div class="stemblock">
<div class="content">
\[t_{n+1} = t^*+\frac{k_{n+1}}{2},\quad k_{n+1}=k^*+\frac{k_{n+1}}{2},\quad \mathbf{u}^{n+1}=\mathbf{u}^*+\frac{1}{2}k_{n+1} \mathbf{d}^n,\quad \frac{\partial \mathbf{u}^{n+1}}{\partial t}=\mathbf{d}^n\]
</div>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><strong>Warning</strong> Denote \(h\) the trace of the velocity on Dirichlet boundaries depending on space and time, i.e. \(\mathbf{u}(x,t) = h(x,t) \quad \forall x \in \partial \Omega_D \mbox{ and } t &gt; 0\), then note that in general \(h(x,\frac{t^n+t^{n-1}}{2}) \neq \frac{1}{2}(h(x, t^n) + h(x,t^{n-1}))\) which means that we need to update the Dirichlet boundary conditions for \(\mathbf{u}^n\) and \(\mathbf{u}^{n+1}\) after averaging using say <code>on()</code>.</p>
</div>
</blockquote>
</div>
<div class="ulist bibliography">
<div class="title">Bibliography</div>
<ul class="bibliography">
<li>
<p><a id="kay"></a>[kay] Adaptive time-stepping for incompressible flow part ii: Navier-stokes equations, DA Kay, PM Gresho, DF Griffiths, DJ Silvester - SIAM Journal on Scientific Computing, 2010</p>
</li>
</ul>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="bdf.html">BDF</a></span>
  <span class="next"><a href="../exporter.html">Post-processing and Visualization</a></span>
</nav>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <div class="container">
    <div class="sharethis-inline-share-buttons"></div>
    <div class="footer-links">
      <div class="col">
        <div class="footer-logo">
          <a href="https://www.cemosis.fr" class="icon">
            <img src="../../../../_/img/logoCemosisTransparent.png" alt="Cemosis">
          </a>
        </div>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://docs.cemosis.fr" target="_blank" rel="noopener">Projects Documentation</a></li>
          <li><a href="https://join.slack.com/t/feelpp/shared_invite/zt-2qe0q9hw-4pVbhohCXUE6Po9Ma8dbiQ" target="_blank" rel="noopener">Forums(Slack)</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://www.cemosis.fr" target="_blank" rel="noopener">Cemosis</a></li>
          <li><a href="https://www.cemosis.fr/news" target="_blank" rel="noopener">News</a></li>
          <li><a href="https://www.cemosis.fr/projects" target="_blank" rel="noopener">Projects</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://docs.feelpp.org" target="_blank" rel="noopener">Feel++ Documentation</a></li>
          <li><a href="http://docs.feelpp.org/user/">Get Started</a></li>
          <li><a href="http://docs.feelpp.org/user//install/distributions/">Downloads</a></li>
        </ul>
      </div>
      <div class="col">
        <ul class="social-icons">
          <li>
            <svg  width="14" height="14" viewBox="0 0 32 32"> <path id="facebook" class="cls-1" d="M29,0H3A2.652,2.652,0,0,0,0,3V29a2.652,2.652,0,0,0,3,3H16V18H12V14h4V12a6.452,6.452,0,0,1,6-6h4v4H22a2.151,2.151,0,0,0-2,2v2h6l-1,4H20V32h9a2.652,2.652,0,0,0,3-3V3A2.652,2.652,0,0,0,29,0Z"/></svg>
            <a href="https://www.facebook.com/cemosis.fr" class="icon">
            Facebook
            </a>
          </li>
          <li>
            <svg  width="14" height="14" viewBox="0 0 32.1 26.1"> <path id="twitter" class="cls-1" d="M32,7.1a11.836,11.836,0,0,1-3.8,1,6.462,6.462,0,0,0,2.9-3.6,12.606,12.606,0,0,1-4.2,1.6A6.492,6.492,0,0,0,22.1,4a6.594,6.594,0,0,0-6.6,6.6,7.719,7.719,0,0,0,.2,1.5A18.458,18.458,0,0,1,2.2,5.2a6.294,6.294,0,0,0-.9,3.3A6.765,6.765,0,0,0,4.2,14a6.109,6.109,0,0,1-3-.8v.1a6.543,6.543,0,0,0,5.3,6.4,4.678,4.678,0,0,1-1.7.2,4.869,4.869,0,0,1-1.2-.1,6.679,6.679,0,0,0,6.1,4.6,12.917,12.917,0,0,1-8.2,2.8,9.151,9.151,0,0,1-1.6-.1,18.438,18.438,0,0,0,10.1,3c12.1,0,18.7-10,18.7-18.7v-.8A13.336,13.336,0,0,0,32,7.2Z" transform="translate(0.1 -4)"/></svg>
            <a href="https://twitter.com/cemosis" class="icon">
              Twitter
            </a>
          </li>
          <li>
          <svg  width="14" height="14" viewBox="0 0 32 32"> <path id="linkedin" class="cls-1" d="M29,0H3A3.076,3.076,0,0,0,0,3V29a3.009,3.009,0,0,0,3,3H29a2.946,2.946,0,0,0,3-3V3A3.009,3.009,0,0,0,29,0ZM12,26H8V12h4ZM10,10a2,2,0,1,1,2-2A2.006,2.006,0,0,1,10,10ZM26,26H22V18a2,2,0,0,0-4,0v8H14V12h4v2.5c.8-1.1,2.1-2.5,3.5-2.5A4.736,4.736,0,0,1,26,17Z"/></svg>
              <a href="https://www.linkedin.com/company/cemosis" class="icon">
             Linkedin
            </a>
          </li>
        </ul>
      </div>
    </div>
    <div class="footer-terms">
      <div class="footer-terms-copyright">
          <span>© 2023 Cemosis, Université de Strasbourg</span>
      </div>
      <div class="footer-terms-links">
        <a href="https://www.cemosis.fr/terms-of-use">Terms of Use</a>
        <a href="https://www.cemosis.fr/privacy-policy">Privacy Policy</a>
        <a href="https://www.cemosis.fr/cookie-policy">Cookie Policy</a>
        <a href="https://www.cemosis.fr/support-policy">Support Policy</a>
      </div>
    </div>
  </div>
</footer>
<script id="site-script" src="../../../../_/js/site.js" data-ui-root-path="../../../../_"></script>


<script async src="../../../../_/js/vendor/fontawesome-icon-defs.js"></script>
<script async src="../../../../_/js/vendor/fontawesome.js"></script>
<script async src="../../../../_/js/vendor/highlight.js"></script>

<script async id="search-script" src="../../../../_/js/vendor/docsearch.js" data-app-id="03CF2L5SFL" data-api-key="53f606259c1ee7b82a42956e0c776c3d" data-index-name="feelpp" data-stylesheet="../../../../_/css/vendor/docsearch.css">
</script>


<script type="text/javascript">
function toggleFullScreen() {
   var doc = window.document;
   var docEl = doc.documentElement;

   var requestFullScreen = docEl.requestFullscreen || docEl.mozRequestFullScreen || docEl.webkitRequestFullScreen || docEl.msRequestFullscreen;
   var cancelFullScreen = doc.exitFullscreen || doc.mozCancelFullScreen || doc.webkitExitFullscreen || doc.msExitFullscreen;

   if(!doc.fullscreenElement && !doc.mozFullScreenElement && !doc.webkitFullscreenElement && !doc.msFullscreenElement) {
       requestFullScreen.call(docEl);
   }
   else {
       cancelFullScreen.call(doc);
   }
}
</script>  </body>
</html>
