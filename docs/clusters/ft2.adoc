= Finis Terrae
// Don't put authors here! (see CONTRIBUTING)
//*******************************************
:page-root: ../../
:page-layout: manual
:page-permalink: /clusters/ft2/
:doctype: book
:docinfo: shared
:toc: left
:toclevels: 1
:sectnums:
:imagesdir: ../images/
// Keep this include header at the end! (see CONTRIBUTING)
include::../includes/header.adoc[]
//*******************************************

include::../includes/topnote.adoc[]

image::clusters/ft2.jpg[float="right",align="center"]

CESGA Computing Center

== Preriquisites

* You have to own an account on the machine. See the 
link:https://services-numeriques.unistra.fr/les-services-aux-usagers/hpc/acces-aux-ressources.html[cluster documentation]
for the first step on the cluster.
* To use differents libraries version that match your need, the cluster uses link:http://modules.sourceforge.net/[environment modules]
You should familiarize first to know how to load specific softwares.
* The cluster use link:https://slurm.schedmd.com/quickstart.html[slurm] job supervisor.
You should be familiar with job creation and job submission before going further.

== Feel++ usage

=== Compilation

WARNING: Work in progress

We provide some scripts to [install dependencies](https://github.com/feelpp/feelpp/tree/develop/ports/cesga).

You have to load the required environment

include::{uri-source}/ports/cesga/environment[]

=== Singularity

See [[singularity]] section for more details about this container solution.

WARNING: Work in progress

How to launch Feel++ with singularity at FinisTerrae II

==== Slurm (job scripts)

===== Script 1
Launch `feelpp_qs_laplacian_2d` in two task in different nodes.
[source,bash]
----
#!/bin/bash
#SBATCH -p cola-corta
#SBATCH -N 2
#SBATCH -n 2
#SBATCH -t 00:10:00
#SBATCH --ntasks-per-node=1

module purge
module load gcc/5.3.0 openmpi/1.10.2 singularity/2.2.1 feelpp-toolboxes/0.102.00

mpirun feelpp-toolboxes  feelpp_qs_laplacian_2d
----

===== Script 2
Change Feel++ output directory and launch `feelpp_toolbox_fluid_2d` in two task in different nodes.
[source,bash]
----
#!/bin/bash
#SBATCH -p cola-corta
#SBATCH -N 2
#SBATCH -n 2
#SBATCH -t 00:10:00
#SBATCH --ntasks-per-node=1

module purge
module load gcc/5.3.0 openmpi/1.10.2 singularity/2.2.1 feelpp-toolboxes/0.102.00

mpirun feelpp-toolboxes  "export FEELPP_REPOSITORY=$PWD && feelpp_toolbox_fluid_2d --config-file=PATH-TO/TurekHron/cfd1.cfg"
----

== Acknowledgments

The support of {feelpp} @ CESGA has been funded by the EU E-INFRA H2020 project link:http://mso4sc.eu[MSO4SC].
