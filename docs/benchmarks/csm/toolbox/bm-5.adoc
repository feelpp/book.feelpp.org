= Torsion Bar Benchmarks
// Don't put authors here! (see CONTRIBUTING)
//*******************************************
:page-layout: manual
:page-permalink: /benchmarks/csm/toolbox/bm-5/
:page-root: ../../../../
:title: Torsion Bar CSM Benchmark
:doctype: book
:docinfo: shared
:imagesdir: /images/
:sources: ../../../
// Keep this include header at the end! (see CONTRIBUTING)
include::../../../includes/header.adoc[]
//*******************************************

TIP: Toolbox is available at link:/toolbox/csm[CSM Toolbox].

//:toclevels: 4
//:leveloffset: +1


== Introduction

We simulate the torsion of a beam generated by a circular motion at one extremities and fixed to the other side.
The material is considered NeoHookean compressible.


== Inputs

We consider an hyper-elastic material

[source,json]
----
include::https://raw.githubusercontent.com/feelpp/feelpp/develop/toolboxes/solid/torsionbar/torsionbar.json[lines=5]
----

=== Parameters

[source,json]
----
include::https://raw.githubusercontent.com/feelpp/feelpp/develop/toolboxes/solid/torsionbar/torsionbar.json[lines=16..23]
----

=== Materials

[source,json]
----
include::https://raw.githubusercontent.com/feelpp/feelpp/develop/toolboxes/solid/torsionbar/torsionbar.json[lines=6..15]
----

=== Boundary Conditions

[source,json]
----
include::https://raw.githubusercontent.com/feelpp/feelpp/develop/toolboxes/solid/torsionbar/torsionbar.json[lines=24..63]
----

== Outputs

We compute the followig fields:

* the process id (domain partitioning)
* the displacement of the beam,
* the Von-Mises criterium


We monitor also the output `VolumeVariation`.

[source,json]
----
include::https://raw.githubusercontent.com/feelpp/feelpp/develop/toolboxes/solid/torsionbar/torsionbar.json[lines=64..72]
----

== Running the model

The configuration file is in `/usr/local/share/feelpp/testcases/CSM/torsionbar/torsionbar.cfg`.
The command line in feelpp-toolboxes docker or singularity reads 

.Command line to execute the torsionbar testcase
[source,sh]
----
$ mpirun -np 4 /usr/local/bin/feelpp_toolbox_solid_3d --config-file torsionbar.cfg
----

== Results

=== 3D model

In the window below, you can manipulate the 3D model at the final time step.

.3D Model of the torsion of a NeoHookean Beam.
++++

<div class="stretchy-wrapper-16_9">
<div id="vtkVisuSection1" style="margin: auto; width: 100%; height: 100%;      padding: 10px;"></div>
</div>
<script type="text/javascript" src="/js/visu-vtk.js"></script>
<script type="text/javascript">
feelppVtkJs.createSceneImporter( vtkVisuSection1, {
                                 fileURL: "https://girder.math.unistra.fr/api/v1/file/5a687a58b0e9570150cb252d/download",
                                 onlyOneObjectVisible: true,
                                 defaultSceneObject: "displacement" } );
</script>

++++

NOTE: Click top left button on opengl window to change basic visualisation features

=== Video

The video below shows the torsion of the beam at different steps.

++++
<div class="videoblock">
<div class="title">Torsion of a NeoHookean beam</div>
<div class="stretchy-wrapper-16_9">
<div class="content" style="margin: auto; width: 100%; height: 100%">
<iframe width="100%" height="100%" src="https://www.youtube.com/embed/nfi_xwR-H1k?rel=0&amp;autoplay=1&amp;loop=1&amp;playlist=nfi_xwR-H1k&amp;theme=light" frameborder="0" allowfullscreen></iframe>
</div>
</div>
</div>
++++

//.Torsion of a NeoHookean beam
//video::nfi_xwR-H1k[youtube,width=1262, height=720, opts="autoplay,loop",theme=light]

=== Volume variation

[%header,format=csv]
|===
include::https://girder.math.unistra.fr/api/v1/file/5a68875ab0e9570150cb2530/download[lines=1;21;41;61;81;101;121;141;161;181;201;221;241;261;281;301]
|===

++++

<div>
    <a href="https://plot.ly/~prudhomme/90/?share_key=d13kqn90qz39uvTqABnR4G" target="_blank" title="TorsionBarPlot" style="display: block; text-align: center;"><img src="https://plot.ly/~prudhomme/90.png?share_key=d13kqn90qz39uvTqABnR4G" alt="TorsionBarPlot" style="max-width: 100%;width: 600px;"  width="600" onerror="this.onerror=null;this.src='https://plot.ly/404.png';" /></a>
    <script data-plotly="prudhomme:90" sharekey-plotly="d13kqn90qz39uvTqABnR4G" src="https://plot.ly/embed.js" async></script>
</div>



++++

=== Expected performance

The results have been obtained in 868 second by using 24 cores on one node of the https://gitlab.math.unistra.fr/atlas/cluster-doc/wikis/description[Atlas] cluster (Intel Xeon E5-2680 v3 2.50GHz).

//:leveloffset: -1
