<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>The Poisson equation with Coefficient Form PDEs toolbox :: Feel++ Docs</title>
    <link rel="prev" href="cfpdes.index.html">
    <link rel="next" href="cfpdes.adr.html">
    <meta name="generator" content="Antora 3.1.4">
    <link rel="stylesheet" href="../../../../_/css/site.css">
<link rel="icon" href="../../../../_/img/favicon.ico" type="image/x-icon">
<script>!function(l,p){if(l.protocol!==p&&l.host=="docs.antora.org"){l.protocol=p}else if(/\.gitlab\.io$/.test(l.host)){l.replace(p+"//docs.antora.org"+l.pathname.substr(l.pathname.indexOf("/",1))+l.search+l.hash)}}(location,"https:")</script>

<script src="../../../../_/js/vendor/tabs-block-extension.js"></script>
<script src="../../../../_/js/vendor/tabs-block-behavior.js"></script>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  messageStyle: "none",
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$'], ['\\[','\\]']],
    processEscapes: true,
    processEnvironments: true,
    ignoreClass: "nostem|nolatexmath"
  },
  asciimath2jax: {
    delimiters: [["\\$", "\\$"]],
    ignoreClass: "nostem|noasciimath"
  },

  TeX: {
      Macros: {
      RR: "{\\mathbb R}",
      NN: "{\\mathbb N}",
      Nso: "{N_{\\mathrm{so}}}",
      Nma: "{N_{\\mathrm{ma}}}",
      Nno: "{N_{\\mathrm{no}}}",
      Ne: "{N_{\\mathrm{e}}}",
      Ilag: ["{\\mathcal{I}^{\\mathrm{lag}}_{#1}}",1],
      calTh: "{\\mathcal{T}_h}",
      Ck: ["{\\mathcal{C}^{#1}}",1],
      Pk: ["{\\mathcal{P}^{#1}}",1],
      Qk: ["{\\mathcal{Q}^{#1}}",1],
      Pch: ["{P^{#1}_{c,h}}",1],
      Pcho: ["{P^{#1}_{c,h,0}}",1],
      Qch: ["{Q^{#1}_{c,h}}",1],
      Ich: ["{\\mathcal{I}^{#1}_{c,h}#2}",2],
      poly: ["{\\mathbb{#1}}",1],
      nf: "{n_f}",
      ngeo: "{n_{\\mathrm{geo}}}",
      geo: "{\\mathrm{geo}}",
      card: ["{\\operatorname{card}(#1)}",1],
      dim: ["{\\operatorname{dim}(#1)}",1],
      opdim: "{\\operatorname{dim}}",
      card: ["{\\operatorname{card}(#1)}",1],
      poly: ["{\\mathbb{#1}",1],
      R: ["{\\mathbb{R}^{#1}}",1],
      set: ["{\\left\\{#1\\right\\}}",1],
      diam: "{\\operatorname{diam}}",
      jump: ["{[\\![ #1 ]\\!]}",1],
      Next: "{\\mathrm{n}}",
      essinf: "{\\operatorname{ess}\\, \\operatorname{inf}}",
      tr: "{\\operatorname{tr}}",
      Id: "{\\mathcal{I}}",
      disp: ["{\\mathbf{#1}}",1],
      stresst: ["{\\mathbf{\\sigma(#1)}}",1],
      deformt: ["{\\mathbf{\\varepsilon(#1)}}",1],
      domain: "{\\Omega}",
      prect: ["{\\left\\(#1\\right\\)}",1],
      ds: "",
      bold: ["{\\bf #1}",1],
      p: "{\\mathrm{p}}",
      q:"{\\mathbf{q}}",
      n:"{\\mathbf{n}}",
      T:"{\\mathcal{T}}",
      F:"{\\mathcal{F}}",
      P:"{\\mathcal{P}}",
      v:"{\\mathbf{v}}"
  },
  extensions: ["mhchem.js"] }
});
</script>
<!--<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/MathJax.js?config=TeX-MML-AM_CHTML"></script>-->
<!-- <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML' async></script> -->
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_CHTML'>
</script>
<!--<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.6.0/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script>-->

<!--<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0/katex.min.css" integrity="sha384-TEMocfGvRuD1rIAacqrknm5BQZ7W7uWitoih+jMNFXQIbNl16bO8OZmylH/Vi/Ei" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0/katex.min.js" integrity="sha384-jmxIlussZWB7qCuB+PgKG1uLjjxbVVIayPJwi6cG6Zb4YKq0JIw+OMnkkEC7kYCq" crossorigin="anonymous"></script>-->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-65761593-1"></script>
<script>function gtag(){dataLayer.push(arguments)};window.dataLayer=window.dataLayer||[];gtag('js',new Date());gtag('config','UA-65761593-1')</script>
<script>var uiRootPath = '../../../../_'</script>

<script type='text/javascript' src='https://platform-api.sharethis.com/js/sharethis.js#property=5f34e90f94876f0012457ea1&product=sop' async='async'></script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar  navbar-expand-sm bg-dark navbar-dark">
    <div class="navbar-brand">
      <div class="navbar-item feelpp-logo">
        <a href="https://docs.feelpp.org"><img src="../../../../_/img/feelpp-logo.svg" alt="Feel++ logo"/></a>
      </div>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <div class="navbar-item search hide-for-print">
          <form class="search">
            <i class="fa-solid fa-search"></i>
            <input type="text" placeholder="Search Feel++ Docs" class="query" id="search-query">
          </form>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <div class="navbar-link">Manuals</div>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://docs.feelpp.org/user/">User</a>
            <a class="navbar-item" href="https://docs.feelpp.org/dev/">Developer</a>
            <a class="navbar-item" href="https://docs.feelpp.org/toolbox/">Toolbox</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <div class="navbar-link" data-title="Support">
            <span class="icon"><img src="../../../../_/img/octicons-24.svg#view-comment-discussion"></span>
          </div>
          <div class="navbar-dropdown is-right">
            <a class="navbar-item has-icon" href="https://join.slack.com/t/feelpp/shared_invite/zt-2qe0q9hw-4pVbhohCXUE6Po9Ma8dbiQ" target="_blank" rel="noopener">
              <span class="icon"><img src="../../../../_/img/slack-icon.svg"></span>
              <span>Chat</span>
            </a>
            <a class="navbar-item has-icon" href="https://github.com/orgs/feelpp/discussions" target="_blank" rel="noopener">
              <span class="icon"><img src="../../../../_/img/octicons-16.svg#view-discussion-closed"></span>
              <span>Discussions</span>
            </a>
            <a class="navbar-item has-icon" href="https://github.com/feelpp" target="_blank" rel="noopener">
              <span class="icon"><img src="../../../../_/img/octicons-16.svg#view-mark-github"></span>
              <span>Source</span>
            </a>
            <a class="navbar-item has-icon" href="https://twitter.com/feelpp" target="_blank" rel="noopener">
              <span class="icon"><img src="../../../../_/img/octicons-16.svg#view-hash"></span>
              <span>Tweets</span>
            </a>
            <a class="navbar-item has-icon" href="https://github.com/feelpp/book.feelpp.org/issues/new">
              <span class="icon"><img src="../../../../_/img/octicons-16.svg#view-bug"></span>
              <span>Issues</span>
            </a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable download-item">
          <div class="navbar-item"><div class="download-btn">Get Feel++</div></div>
          <div class="navbar-dropdown is-right">
              <a class="navbar-item" href="../../../stable/install/index.html" target="_blank" rel="noopener">
                <span>Stable (0.110)</span>
              </a>
              <a class="navbar-item" href="../../install/index.html" target="_blank" rel="noopener">
                <span>Latest</span>
              </a>
          </div>
        </div>
        <div class="navbar-item">
          <a class="navbar-brand"  href="https://www.cemosis.fr">
            <img class="cemosis-logo"  src="../../../../_/img/cemosis-logo.svg" alt="Cemosis logo"/>
          </a>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<a href="#" class="menu-expand-toggle"></a>
<div class="nav-container" data-component="user" data-version="latest">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../../index.html">Feel++ User Manual</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../index.html">Introduction</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../index.html#feelpp">What is Feel++?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../index.html#purpose">What is the purpose of this manual ?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../index.html#scope">What is the scope of this manual?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../index.html#target">Who is this book for?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../index.html#discuss">Where to discuss about this manual</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../index.html#contribute">How to contribute to this manual</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../how-feelpp-works.html">How Feel++ works</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../install/index.html">Get Feel++</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../install/containers.html">Install From Containers</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../install/sources.html">Get Feel++ From Sources</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../install/prerequisites-dev.html">Programming Environment</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../install/linux.html">Linux</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../install/mac.html">Mac</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../install/windows.html">Windows</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../install/compiling-external-projects.html">Compiling Third Party Software</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../install/compile.html">Compiling</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../install/test.html">Testing</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../../stable/using/index.html">Using Feel++</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../../stable/using/docker.html">Starting Feel++ with Docker</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../stable/using/docker.html#installation">Installation</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../stable/using/docker.html#usage">Usage</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../stable/using/expr.html">Using mathematical expressions</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Using Feel++ Tools</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../stable/using/tools/remotedata.html">Remote Data</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../stable/using/tools/mesh_partitioner.html">Mesh Partitioner</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../stable/using/tools/mesh_exporter.html">Mesh Exporter</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../stable/using/tools/fmu.html">FMI FMU</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Using Feel++ Toolboxes</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../stable/using/toolboxes/fluid.html">Computational Fluid Mechanics</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../stable/using/toolboxes/solid.html">Computational Solid Mechanics</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../stable/using/toolboxes/fsi.html">Fluid Structure Interaction</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../stable/using/toolboxes/heat.html">Heat Transfer</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../stable/using/toolboxes/heatfluid.html">Heat Transfer and Fluid</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../stable/using/toolboxes/electric.html">Electric</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../stable/using/toolboxes/thermoelectric.html">Thermo-Electric</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../stable/using/toolboxes/hdg_poisson.html">HDG Poisson</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../stable/using/toolboxes/hdg_elasticity.html">HDG Elasticity</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../stable/using/toolboxes/hdg_coupledpoisson.html">HDG Coupled Poisson</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../cpp/index.html">Using Feel++ in C++</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../cpp/laplacian.html">Minimal application</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../index.html">Using Feel++ in Python</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../pyfeelpp/index.html">pyFeel++</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../pyfeelpp/core.html">Initializing Feel++</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../pyfeelpp/mesh.html">Creating a mesh</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../pyfeelpp/expr.html">Manipulating Expressions</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../pyfeelpp/discr.html">Manipulating functions and function spaces</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../pyfeelpp/integrals.html">Computing integrals</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../pyfeelpp/filters.html">Exporting results for visualisation</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="index.html">pyFeel++ Toolboxes</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="modelproperties.html">Model Properties</a>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="cfpdes.index.html">Coefficient Formulation PDEs</a>
<ul class="nav-list">
  <li class="nav-item is-current-page" data-depth="4">
    <a class="nav-link" href="cfpdes.poisson.html">Coefficient Formulation PDEs Poisson Equation</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="cfpdes.adr.html">Coefficient Formulation PDEs Advection Diffusion Equation  Equation</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="cfpdes.linearelasticity.html">Coefficient Formulation PDEs Linear Elasticity Equation</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../pyfeelppmor/index.html">pyFeel++ MOR</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../pyfeelppmor/parameterSpace.html">Parameter space</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../pyfeelppmor/parameters.html">Parameters</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../pyfeelppmor/petscDouble.html">PETSc vector and matrix</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../pyfeelppmor/toolboxmor.html">Toolbox MOR</a>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../pyfeelppmor/reducedbasis.html">Python module <code>reducedbasis</code></a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../pyfeelppmor/reducedbasis_offline.html">Offline stage</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../stable/conclusion/index.html">What&#8217;s Next?</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../../../feelpp/stable/acknowledgments.html">Acknowledgments</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../../feelpp/stable/acknowledgments.html#_funding">Funding</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../../feelpp/stable/acknowledgments.html#_contributors">Contributors</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../../feelpp/stable/consortium.html">Consortium</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../stable/conclusion/glossary.html">Glossary</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Feel++ User Manual</span>
    <span class="version">latest</span>
  </div>
  <ul class="components">
      <li class="component is-current">
        <a class="title" href="../../../stable/index.html">Feel++ User Manual</a>
          <ul class="versions">
              <li class="version is-current">
                <a href="../../index.html">latest</a>
              </li>
              <li class="version is-latest">
                <a href="../../../stable/index.html">0.110</a>
              </li>
              <li class="version">
                <a href="../../../0.109/index.html">0.109</a>
              </li>
          </ul>
      </li>
      <li class="component">
        <a class="title" href="../../../../dev/stable/index.html">Developer manual</a>
          <ul class="versions">
              <li class="version">
                <a href="../../../../dev/latest/index.html">latest</a>
              </li>
              <li class="version is-latest">
                <a href="../../../../dev/stable/index.html">0.110</a>
              </li>
              <li class="version">
                <a href="../../../../dev/0.109/index.html">0.109</a>
              </li>
          </ul>
      </li>
      <li class="component">
        <a class="title" href="../../../../data/stable/index.html">Data Manual</a>
          <ul class="versions">
              <li class="version">
                <a href="../../../../data/latest/index.html">latest</a>
              </li>
              <li class="version is-latest">
                <a href="../../../../data/stable/index.html">0.110</a>
              </li>
              <li class="version">
                <a href="../../../../data/0.109/index.html">0.109</a>
              </li>
          </ul>
      </li>
      <li class="component">
        <a class="title" href="../../../../math/index.html">Feel++ Mathematics</a>
          <ul class="versions">
              <li class="version is-latest">
                <a href="../../../../math/index.html">master</a>
              </li>
          </ul>
      </li>
      <li class="component">
        <a class="title" href="../../../../toolboxes/stable/index.html">Feel++ Toolboxes Manual</a>
          <ul class="versions">
              <li class="version">
                <a href="../../../../toolboxes/latest/index.html">latest</a>
              </li>
              <li class="version is-latest">
                <a href="../../../../toolboxes/stable/index.html">0.110</a>
              </li>
              <li class="version">
                <a href="../../../../toolboxes/0.109/index.html">0.109</a>
              </li>
          </ul>
      </li>
      <li class="component">
        <a class="title" href="../../../../cases/stable/index.html">Feel++ Toolbox Cases Guide</a>
          <ul class="versions">
              <li class="version">
                <a href="../../../../cases/latest/index.html">latest</a>
              </li>
              <li class="version is-latest">
                <a href="../../../../cases/stable/index.html">0.110</a>
              </li>
              <li class="version">
                <a href="../../../../cases/0.109/index.html">0.109</a>
              </li>
          </ul>
      </li>
      <li class="component">
        <a class="title" href="../../../../angiotk/stable/index.html">AngioTK User Manual</a>
          <ul class="versions">
              <li class="version is-latest">
                <a href="../../../../angiotk/stable/index.html">0.1</a>
              </li>
          </ul>
      </li>
      <li class="component">
        <a class="title" href="../../../../salome/stable/index.html">Feel++ and Salome</a>
          <ul class="versions">
              <li class="version is-latest">
                <a href="../../../../salome/stable/index.html">current</a>
              </li>
          </ul>
      </li>
      <li class="component">
        <a class="title" href="../../../../feelpp/stable/index.html">Feel++ Documentation</a>
          <ul class="versions">
              <li class="version is-latest">
                <a href="../../../../feelpp/stable/index.html">0.110</a>
              </li>
              <li class="version">
                <a href="../../../../feelpp/0.109/index.html">0.109</a>
              </li>
          </ul>
      </li>
      <li class="component">
        <a class="title" href="../../../../feelpp-tutorial-dev/index.html">Feel++ Programming Tutorial</a>
      </li>
      <li class="component">
        <a class="title" href="../../../../feelpp-project/index.html">Feel++ Project</a>
      </li>
      <li class="component">
        <a class="title" href="../../../../mor/stable/index.html">Model Order Reduction</a>
          <ul class="versions">
              <li class="version">
                <a href="../../../../mor/latest/index.html">latest</a>
              </li>
              <li class="version is-latest">
                <a href="../../../../mor/stable/index.html">0.110</a>
              </li>
              <li class="version">
                <a href="../../../../mor/0.109/index.html">0.109</a>
              </li>
          </ul>
      </li>
      <li class="component">
        <a class="title" href="../../../../contribute/index.html">Toolbox Contribution Guide</a>
          <ul class="versions">
              <li class="version is-latest">
                <a href="../../../../contribute/index.html">master</a>
              </li>
          </ul>
      </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
  <button class="nav-toggle"></button>
    <a href="../../../../home/index.html" class="home-link"></a>
  <nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../index.html">Feel++ User Manual</a></li>
    <li><a href="../index.html">Using Feel++ in Python</a></li>
    <li><a href="index.html">pyFeel++ Toolboxes</a></li>
    <li><a href="cfpdes.index.html">Coefficient Formulation PDEs</a></li>
    <li><a href="cfpdes.poisson.html">Coefficient Formulation PDEs Poisson Equation</a></li>
  </ul>
</nav>

  <div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">latest</button>
  <div class="version-menu">
    <a class="version is-current" href="cfpdes.poisson.html">latest</a>
    <a class="version is-missing" href="../../../stable/index.html">0.110</a>
    <a class="version is-missing" href="../../../0.109/index.html">0.109</a>
  </div>
</div>

    <div class="edit-this-page"><a href="https://github.com/feelpp/book.feelpp.org/edit/develop/docs/user/modules/python/pages/pyfeelpptoolboxes/cfpdes.poisson.adoc">Edit this Page</a></div>
  
  <div class="page-downloads">
  <span class="label">Download as</span>
  <ul class="download-options">
    <li>
      <a onclick="print(this)" href="#" data-toggle="tooltip" data-placement="left" title="Print to PDF"
         class="pdf-download">
        <img class="pdf-file-icon icon" src="../../../../_/img/pdf.svg"/> .pdf
      </a>
    </li>
      <li>
        <a href="../_attachments/pyfeelpptoolboxes/cfpdes.poisson.ipynb"
           title="Download Jupyter Notebook" data-toggle="tooltip" data-placement="left" class="jupyter-download">
          <img class="jupyter-file-icon icon" src="../../../../_/img/jupyter-logo.svg"/> .ipynb
        </a>
      </li>
  </ul>
</div>
</div>

  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">The Poisson equation with Coefficient Form PDEs toolbox</h1>
<div class="sect1">
<h2 id="_introduction"><a class="anchor" href="#_introduction"></a>1. Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This page is devoted to the finite element approximation of coercive problems.</p>
</div>
<div class="paragraph">
<p>The prototype is the Dirichlet problem: given a function \(f: \Omega \rightarrow \mathbb{R}\),  look for a function \(u: \Omega \rightarrow \mathbb{R}\) such that</p>
</div>
<div id="laplace" class="stemblock">
<div class="content">
\[\begin{equation*}
\begin{aligned}
-\Delta u &amp; =f &amp; &amp; \text { in } \Omega, \\
u &amp; =0 &amp; &amp; \text { on } \partial \Omega,
\end{aligned}
\end{equation*}\]
</div>
</div>
<div class="paragraph">
<p>where \(\Delta u=\sum_{i=1}^d \partial_{i i}^2 u\) is the Laplacian of \(u\).</p>
</div>
<div class="paragraph">
<p>Equation <a href="#laplace">[laplace]</a>, which imposes the nullity of the solution \(u\) on the domain boundary, is called a homogeneous Dirichlet boundary condition.</p>
</div>
<div class="paragraph">
<p>Other boundary conditions (non-homogeneous Dirichlet, Neumann or Robin) are possible and will be discussed later on.</p>
</div>
<div class="paragraph">
<p>The problem is used in many physical models, in particular</p>
</div>
<div class="ulist">
<ul>
<li>
<p>in heat transfer where \(u\) represents the temperature,</p>
</li>
<li>
<p>in electrostatics where \(u\) represents an electric potential,</p>
</li>
<li>
<p>in mechanics where \(u\) represents a vertical membrane displacement, and</p>
</li>
<li>
<p>in hydraulics where \(u\) represents a charge in a Darcy flow.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A second example of a coercive problem is the advection-diffusion-reaction equations with dominant diffusion which we shall study <a href="cfpdes.adr.html" class="xref page">here</a>.</p>
</div>
<div class="paragraph">
<p>A third example is provided by the mechanics of continuous deformable media in the framework of linear elasticity which we shall study <a href="cfpdes.linearelasticity.html" class="xref page">here</a>.
In this case, the unknown is a function \(u: \Omega \rightarrow \mathbb{R}^d\) which represents a displacement field.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Coercive problems provided the first framework for the application of the finite element method, when engineers used this method in the 1950&#8217;s to approximate the solution of deformable continuum mechanics problems.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The mathematical analysis of coercivity problems is relatively simple since it is based on the Lax-Milgram lemma.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_the_mathematical_framework"><a class="anchor" href="#_the_mathematical_framework"></a>2. The mathematical framework</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We assume for simplicity that the data \(f\) is in \(L^2(\Omega)\).
The weak formulation of the  <a href="#laplace">homogeneous Dirichlet problem</a> is the following:</p>
</div>
<div id="laplace-varf" class="stemblock">
<div class="content">
\[\begin{equation*}
\left\{\begin{array}{l}
\text { Find } u \in H_0^1(\Omega) \text { such that } \\
\int_{\Omega} \nabla u \ \nabla w=\int_{\Omega} f w, \quad \forall w \in H_0^1(\Omega) .
\end{array}\right.
\end{equation*}\]
</div>
</div>
<div class="paragraph">
<p>Introducing the functional space \(V=H_0^1(\Omega)\), the bilinear form \(a \in \mathcal{L}(V \times V; \mathbb{R})\) defined by \(a(v, w)=\int_{\Omega} \nabla v \cdot \nabla w\) and the linear form \(f \in V^{\prime}\) defined by \(f(w)=\int_{\Omega} f w\), the  <a href="#laplace-varf">problem</a> is written in the following abstract form:</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{equation*}
\left\{\begin{array}{l}
\text { Find } u \in V \text { such that } \\
a(u, w)=f(w), \quad \forall w \in V .
\end{array}\right.
\end{equation*}\]
</div>
</div>
<div class="paragraph">
<p>The space \(V\) equipped with the norm \(\|\cdot\|_{1, \Omega}\) (defined by \(\|v\|_{1, \Omega}=\left(\|v\|_{0, \Omega}^2+\|\nabla v\|_{0, \Omega}^2\right)^{1 / 2}\) for \(v \in V\) ) is a Hilbert space and the forms \(a\) and \(f\) are continuous on \(V \times V\) and \(V\), respectively.
The only non-trivial property to establish the well-posedness of <a href="#laplace-varf">[laplace-varf]</a> is the coercivity of \(a\) on \(H_0^1(\Omega)\).
This results from the following inequality</p>
</div>
<div id="lem:1" class="sidebarblock">
<div class="content">
<div class="title">Lemma: Poincaré inequality</div>
<div class="paragraph">
<p>Let \(\Omega\) be a bounded open of \(\mathbb{R}^d\).
There exists a constant \(\ell_{\Omega}\) such that</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{equation*}
\forall v \in H_0^1(\Omega), \quad\|v\|_{0, \Omega} \leq \ell_{\Omega}||\nabla v\|_{0, \Omega}
\end{equation*}\]
</div>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
the constant \(\ell_{\Omega}\) has the dimension of a length; it can be interpreted as a characteristic length of the bounded open \(\Omega\).
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The Poincaré inequality implies the coercivity of the bilinear form \(a\) on \(H_0^1(\Omega)\) since</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{equation*}
\forall v \in H_0^1(\Omega), \quad a(v, v)=\|\nabla v|_{0, \Omega}^2 \geq \frac{1}{1+\ell_{\Omega}^2}\|v\|_{1, \Omega}^2 .
\end{equation*}\]
</div>
</div>
<div class="paragraph">
<p>The Lax-Milgram lemma allows us to conclude that the <a href="#laplace-varf">problem</a> is well-posed.</p>
</div>
<div class="sect2">
<h3 id="_conforming_approximation"><a class="anchor" href="#_conforming_approximation"></a>2.1. Conforming Approximation</h3>
<div class="paragraph">
<p>We consider a conformal approximation of <a href="#laplace-varf">problem</a>  by Lagrange finite elements.
We assume for simplicity that \(\Omega\) is a \(\mathbb{R}^2\) polygon or a \(\mathbb{R}^3\) polyhedron.
We consider a regular and conformal family of affine meshes of \(\Omega\) which we denote \(\left\{\mathcal{T}_h\right\}_{h&gt;0}\).</p>
</div>
<div class="paragraph">
<p>We choose as finite element of reference \(\left\{\widehat{K}, \widehat{P}, \widehat{\Sigma}\right\}\) a finite element of Lagrange such that \(\mathbb{P}_k \subset \widehat{P}\) and \(k+1&gt;\frac{d}{2}\)</p>
</div>
<div class="paragraph">
<p>We pose</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{equation*}
P_{\mathrm{c}, h}^k=\left\{v_h \in \mathcal{C}^0(\bar{\Omega}); \forall K \in \mathcal{T}_h, v_h \circ T_K \in \widehat{P}\right\}
\end{equation*}\]
</div>
</div>
<div class="paragraph">
<p>where \(T_K\) is the geometric transformation sending \(\widehat{K}\) into \(K\).
The space \(P_{\mathrm{c}, h}^k\) is the space of the functions of \(\mathcal{C}^0(\bar{\Omega})\) which are continuous on the boundary of \(\Omega\) and which are piecewise polynomials of degree \(k\) on each element of \(\mathcal{T}_h\).</p>
</div>
<div class="paragraph">
<p>In order to construct an approximation space which is included in \(V=H_0^1(\Omega)\), we pose</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{equation*}
V_h=P_{\mathrm{c}, h}^k \cap H_0^1(\Omega)
\end{equation*}\]
</div>
</div>
<div class="paragraph">
<p>The elements of \(V_h\) are the functions of \(P_{\mathrm{c}, h}^k\) which are \(0\) on the boundary of \(\Omega\).</p>
</div>
<div class="paragraph">
<p>We consider the following approximate problem:</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{equation*}
\left\{\begin{array}{l}
\text { Find } u_h \in V_h \text { such that } \\
a\left(u_h, v_h\right)=f\left(v_h\right), \quad \forall v_h \in V_h,
\end{array}\right.
\end{equation*}\]
</div>
</div>
<div class="paragraph">
<p>which is clearly well-posed since \(a\) is coercive on \(V\) and \(V_h \subset V\).</p>
</div>
<div id="thm:1" class="sidebarblock">
<div class="content">
<div class="title">Convergence theorem of the conforming approximation</div>
<div class="paragraph">
<p>With the above assumptions, we suppose that the unique solution \(u\) of <a href="#laplace-varf">the problem</a> is in \(H^{k+1}(\Omega) \cap H_0^1(\Omega)\).
Then there exists a constant \(c\) such that for all \(h\),</p>
</div>
<div id="thm:1:1" class="stemblock">
<div class="title">\(H^1\) estimate</div>
<div class="content">
\[\begin{equation*}
\left\|u-u_h\right\|_{1, \Omega} \leq c h^k|u|_{k+1, \Omega}
\end{equation*}\]
</div>
</div>
<div class="paragraph">
<p>where \(|u|_{k+1, \Omega}=\left(\|u\|_{0, \Omega}^2+\|\nabla u\|_{0, \Omega}^2+\dots+\|\nabla^{k+1} u\|_{0, \Omega}^2\right)^{1 / 2}\).
Moreover, if  <a href="#laplace-varf">the problem</a> is regularizing, there exists a constant \(c\) such that for all \(h\),</p>
</div>
<div id="thm:1:2" class="stemblock">
<div class="title">\(L^2\) estimate</div>
<div class="content">
\[\begin{equation*}
\left\|u-u_h\right\|_{0, \Omega} \leq c h^{k+1}|u|_{k+1, \Omega}
\end{equation*}\]
</div>
</div>
<details>
<summary class="title">Notes on the proof</summary>
<div class="content">
<div class="paragraph">
<p>The <a href="#thm:1:1">\(H^1\) estimate</a> results from the lemma of Céa  and an interpolation theorem.
Indeed, we have</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{equation*}
\begin{aligned}
\left\|u-u_h\right\|_{1, \Omega} &amp; \leq c \inf _{v_h \in V_h}\left\|u-v_h\right\|_{1, \Omega} \\
&amp; \leq c\left\|u-\mathcal{I}_h^{\mathrm{Lag}} u\right\|_{1, \Omega} \\
&amp; \leq c h^k|u|_{k+1, \Omega}
\end{aligned}
\end{equation*}\]
</div>
</div>
<div class="paragraph">
<p>where \(\mathcal{I}_h^{\mathrm{Lag}}\) is the Lagrangian interpolation operator.</p>
</div>
<div class="paragraph">
<p>Moreover, the <a href="#thm:1:2">\(L^2\) estimate</a> follows from the Aubin-Nitsche lemma which allows us to state that</p>
</div>
<div class="stemblock">
<div class="title">Aubin-Nitsche lemma</div>
<div class="content">
\[\begin{equation*}
\left\|u-u_h\right\|_{0, \Omega} \leq c h\left|u-u_h\right|_{1, \Omega}
\end{equation*}\]
</div>
</div>
<div class="paragraph">
<p>so that <a href="#thm:1:2">\(L^2\) estimate</a> is deduced from <a href="#thm:1:1">\(H^1\) estimate</a>.</p>
</div>
</div>
</details>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note on \(\mathbb{P}_1\) or \(\mathbb{Q}_1\) finite element approximation</div>
<div class="paragraph">
<p>The generic example of the application of <a href="#thm:1">the previous theorem</a> in dimension 2 or 3 is that of the Lagrangian finite element approximation \(\mathbb{P}_1\) or \(\mathbb{Q}_1\), for which, if <a href="#laplace-varf">the problem</a> is regularizing, we have</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{equation*}
\left\|u-u_h\right\|_{0, \Omega}+h\left\|u-u_h\right\|_{1, \Omega} \leq c h^2\|f\|_{0, \Omega} .
\end{equation*}\]
</div>
</div>
<div class="paragraph">
<p>We thus obtain a convergence to <strong>order 1 in \(H^1\) norm and a convergence to order 2 in \(L^2\) norm.</strong></p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_example_of_homogeneous_dirichlet_problem"><a class="anchor" href="#_example_of_homogeneous_dirichlet_problem"></a>2.2. Example of homogeneous Dirichlet problem</h3>
<div class="paragraph">
<p>We now consider an example to illustrate the <a href="#thm:1">previous theorem</a>.</p>
</div>
<div class="paragraph">
<p>We start by initializing the Feel++ environment.</p>
</div>
<div id="code:1" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">import sys
import feelpp
import feelpp.toolboxes.core as tb
from feelpp.toolboxes.cfpdes import *
import pandas as pd

sys.argv = ["feelpp_cfpdes_poisson"]
e = feelpp.Environment(sys.argv,
                        opts=tb.toolboxes_options("coefficient-form-pdes", "cfpdes"),
                        config=feelpp.globalRepository("cfpdes-poisson-homogeneous-dirichlet"))</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then we consider the \(\mathbb{R}^2\) domain \(\Omega\) defined by \(\Omega=\left\{x \in \mathbb{R}^2; 0 \leq x_1 \leq 1, 0 \leq x_2 \leq 1\right\}\).
We consider the following mesh \(\mathcal{T}_h\) of \(\Omega\) with \(h=0.1\).</p>
</div>
<div id="code:2" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">def generateGeometry(filename,dim=2,hsize=0.1):
    """create gmsh mesh

    Args:
        filename (str): name of the file
        dim (int): dimension of the mesh
        hsize (float): mesh size
    """
    geo="""SetFactory("OpenCASCADE");
    h={};
    dim={};
    """.format(hsize,dim)
    if dim==2 :
        geo+="""
        Rectangle(1) = {0, 0, 0, 1, 1, 0};
        Characteristic Length{ PointsOf{ Surface{1}; } } = h;
        Physical Curve("Gamma_D") = {1,2,3,4};
        Physical Surface("Omega") = {1};
        """
    elif dim==3 :
        geo+="""
        Box(1) = {0, 0, 0, 1, 1, 1};
        Characteristic Length{ PointsOf{ Volume{1}; } } = h;
        Physical Surface("Gamma_D") = {1,2,3,4,5,6};
        Physical Volume("Omega") = {1};
        """
    with open(filename, 'w') as f:
        # Write the string to the file
        f.write(geo)

def getMesh(filename,hsize=0.05,dim=2,verbose=False):
    """create mesh

    Args:
        filename (str): name of the file
        hsize (float): mesh size
        dim (int): dimension of the mesh
        verbose (bool): verbose mode
    """
    import os
    for ext in [".msh",".geo"]:
        f=os.path.splitext(filename)[0]+ext
        # print(f)
        if os.path.exists(f):
            os.remove(f)
    if verbose:
        print(f"generate mesh {filename} with hsize={hsize} and dimension={dim}")
    generateGeometry(filename=filename,dim=dim,hsize=hsize)
    mesh = feelpp.load(feelpp.mesh(dim=dim,realdim=dim), filename, hsize)
    return mesh

# generate 2D abd 3D meshes
for dim in [2,3]:
    mesh = getMesh(f"omega-{dim}d.geo",hsize=0.1,dim=dim,verbose=True)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then we consider the following right hand side \(f\) and the exact solution \(u(x,y) = \sin(2 \pi x) \sin(2 \pi y)\) such that</p>
</div>
<div class="stemblock">
<div class="content">
\[f=-\Delta u = 8 \pi^2 \sin(2 \pi x) \sin(2 \pi y)\]
</div>
</div>
<div class="paragraph">
<p>that way we can check the <a href="#thm:1">Convergence theorem of the conforming approximation</a> with the exact solution.</p>
</div>
<div class="paragraph">
<p>The Coefficient Form PDEs toolbox allows to solve the problem <a href="#laplace-varf">problem</a> with the following code:</p>
</div>
<div id="code:3" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">def laplacian(hsize, json, dim=2,verbose=False):
    if verbose:
        print(f"Solving the laplacian problem for hsize = {hsize}...")
    laplacian = cfpdes(dim=dim, keyword=f"cfpdes-{dim}d")
    laplacian.setMesh(getMesh(f"omega-{dim}.geo",hsize=hsize,dim=dim,verbose=verbose))
    laplacian.setModelProperties(json)
    laplacian.init(buildModelAlgebraicFactory=True)
    laplacian.printAndSaveInfo()
    laplacian.solve()
    laplacian.exportResults()
    measures = laplacian.postProcessMeasures().values()

    return measures

laplacian_json = lambda order,dim=2,name="u":  {
    "Name": "Laplacian",
    "ShortName": "Laplacian",
    "Models":
    {
        f"cfpdes-{dim}d":
        {
            "equations":"laplace"
        },
        "laplace":{
            "setup":{
                "unknown":{
                    "basis":f"Pch{order}",
                    "name":f"{name}",
                    "symbol":"u"
                },
                "coefficients":{
                    "c":"1",

                    "f":"8*pi*pi*sin(2*pi*x)*sin(2*pi*y):x:y" if dim==2 else "12*pi*pi*sin(2*pi*x)*sin(2*pi*y)*sin(2*pi*z):x:y:z"
                }
            }
        }
    },
    "Materials":
    {
        "Omega":
        {
            "markers":["Omega"]
        }
    },
    "BoundaryConditions":
    {
        "laplace":
        {
            "Dirichlet":
            {
                "g":
                {
                    "markers":["Gamma_D"],
                    "expr":"0"
                }
            }
        }
    },
    "PostProcess":
    {
        f"cfpdes-{dim}d":
        {
            "Exports":
            {
                "fields":["all"],
                "expr":{
                    "u_exact":"sin(2*pi*x)*sin(2*pi*y):x:y" if dim==2 else "sin(2*pi*x)*sin(2*pi*y)*sin(2*pi*z):x:y:z",
                    "grad_u_exact": "{2*pi*cos(2*pi*x)*sin(2*pi*y),2*pi*sin(2*pi*x)*cos(2*pi*y)}:x:y" if dim==2 else "{2*pi*cos(2*pi*x)*sin(2*pi*y)*sin(2*pi*z),2*pi*sin(2*pi*x)*cos(2*pi*y)*sin(2*pi*z),2*pi*sin(2*pi*x)*sin(2*pi*y)*cos(2*pi*z)}:x:y:z"
                }
            },
            "Measures" :
            {
              "Norm" :
              {
                  "laplace" :
                  {
                     "type":["L2-error", "H1-error"],
                     "field":f"laplace.{name}",
                     "solution":"sin(2*pi*x)*sin(2*pi*y):x:y" if dim==2 else "sin(2*pi*x)*sin(2*pi*y)*sin(2*pi*z):x:y:z",
                     "grad_solution":"{2*pi*cos(2*pi*x)*sin(2*pi*y),2*pi*sin(2*pi*x)*cos(2*pi*y)}:x:y" if dim==2 else "{2*pi*cos(2*pi*x)*sin(2*pi*y)*sin(2*pi*z),2*pi*sin(2*pi*x)*cos(2*pi*y)*sin(2*pi*z),2*pi*sin(2*pi*x)*sin(2*pi*y)*cos(2*pi*z)}:x:y:z",
                     "markers":"Omega",
                     "quad":6
                 }
              }
            }
        }
    }
}
# simulate the laplacian problem for 2D and 3D
for dim in [2,3]:
    with open(f'laplacian-{dim}d.json', 'w') as f:
        # Write the string to the file
        import json
        f.write(json.dumps(laplacian_json(dim=dim,order=1),indent=1))
        # execute the laplacian problem using P1 basis on a mesh of the unit square  of size 0.1
        laplacian(hsize=0.1,json=laplacian_json(order=1,dim=dim), dim=dim,verbose=True)
# execute the laplacian problem using P2 basis on a mesh of the unit square of size 0.1
#laplacian(hsize=0.025,json=laplacian_json(dim=2,order=2),dim=2,verbose=True)</code></pre>
</div>
</div>
<details class="result">
<summary class="title">Results</summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre>Solving the laplacian problem for hsize = 0.1...
{'Norm_laplace_H1-error': 0.9578973774398879,
 'Norm_laplace_L2-error': 0.0256824272246114}</pre>
</div>
</div>
</div>
</details>
<div class="paragraph">
<p>We can proceed with the visualisation of the field <code>u</code> using the following code using <code>pyvista</code>:</p>
</div>
<div id="code:4" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">from xvfbwrapper import Xvfb <i class="conum" data-value="1"></i><b>(1)</b>
vdisplay = Xvfb()
vdisplay.start()

import pyvista as pv <i class="conum" data-value="2"></i><b>(2)</b>
import os
pv.set_jupyter_backend('panel') <i class="conum" data-value="3"></i><b>(3)</b>
def pv_get_mesh(mesh_path):
    reader = pv.get_reader(mesh_path)
    mesh = reader.read()
    return mesh
def pv_plot(mesh, field, clim=None, cmap='viridis', cpos='xy', show_scalar_bar=True, show_edges=True):
    mesh.plot(scalars=field, clim=clim, cmap=cmap, cpos=cpos, show_scalar_bar=show_scalar_bar, show_edges=show_edges)

def myplots(dim=2, field="cfpdes.laplace.u", factor=1, cmap='viridis'):
    mesh = pv_get_mesh(f"cfpdes-{dim}d.exports/Export.case") <i class="conum" data-value="4"></i><b>(4)</b>
    pv_plot(mesh, field) <i class="conum" data-value="5"></i><b>(5)</b>
    pl = pv.Plotter()
    contours = mesh[0].contour()
    pl.add_mesh(mesh[0], opacity=0.85)
    pl.add_mesh(contours, color="white", line_width=5, render_lines_as_tubes=True)
    pl.show()
    if dim == 2:
        warped = mesh[0].warp_by_scalar(field, factor=factor)
        warped.plot(cmap=cmap, show_scalar_bar=False, show_edges=True)
    else:
        slices = mesh.slice_orthogonal(x=0.2,y=0.4,z=.6)
        slices.plot()

myplots(dim=2,factor=0.5)</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>xvfbwrapper</code> package is used to run the <code>pyvista</code> visualisation in a virtual display. This is necessary when running the code on a remote server.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The <code>pyvista</code> package is used to visualise the mesh and the field <code>u</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The <code>set_jupyter_backend</code> function is used to set the backend to <code>panel</code>, use <code>static</code> instead to render an image and display it in the notebook.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The <code>Export.case</code> file is generated by the <code>cfpdes</code> toolbox. It contains the mesh and the field <code>u</code>. The <code>pyvista</code> package provides a Ensight case reader to read the <code>Export.case</code> file.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>The <code>pyvista</code> package provides a <code>plot</code> function to visualise the mesh and the field <code>u</code> amd the edges of the mesh.</td>
</tr>
</table>
</div>
<details class="result">
<summary class="title">Results</summary>
<div class="content">
<div class="imageblock">
<div class="content">
<img src="../_images/pyfeelpp-toolboxes/cfpdes/cfpdes.laplace.u-pv.png" alt="cfpdes.laplace.u pv" width="50%">
</div>
</div>
</div>
</details>
<div class="paragraph">
<p>In 3D, the plots are more difficult to visualise. We can use the <code>pyvista</code> package to visualise the mesh and the field <code>u</code>:</p>
</div>
<div id="code:4" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">myplots(dim=3)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then we can run the following code to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>compute the solution for different mesh sizes and compute the error in \(L^2\) and \(H^1\) norms</p>
</li>
<li>
<p>compute the convergence rates of the error in \(L^2\) and \(H^1\) norms</p>
</li>
<li>
<p>display the errors in \(L^2\) and \(H^1\) norms in a table</p>
</li>
<li>
<p>check that the convergence rates are close to the expected theoretical values</p>
</li>
</ul>
</div>
<div id="code:4" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">import pandas as pd
import numpy as np

def runLaplacianPk(df,model,verbose=False):
    """generate the Pk case

    Args:
        order (int, optional): order of the basis. Defaults to 1.
    """
    meas=dict()
    dim,order,json=model
    for h in df['h']:
        m=laplacian(hsize=h,json=json,dim=dim,verbose=verbose)
        for norm in ['L2','H1']:
            meas.setdefault(f'P{order}-Norm_laplace_{norm}-error', [])
            meas[f'P{order}-Norm_laplace_{norm}-error'].append(m.pop(f'Norm_laplace_{norm}-error'))
    df=df.assign(**meas)
    for norm in ['L2','H1']:
        df[f'P{order}-laplace_{norm}-convergence-rate']=np.log2(df[f'P{order}-Norm_laplace_{norm}-error'].shift() / df[f'P{order}-Norm_laplace_{norm}-error']) / np.log2(df['h'].shift() / df['h'])
    return df

def runConvergenceAnalysis(json,dim=2,hs=[0.1,0.05,0.025,0.0125],orders=[1,2],verbose=False):
    df=pd.DataFrame({'h':hs})
    for order in orders:
        df=runLaplacianPk(df=df,model=[dim,order,json(dim=dim,order=order)],verbose=verbose)
    print(df.to_markdown()) <i class="conum" data-value="1"></i><b>(1)</b>
    return df

df=runConvergenceAnalysis(json=laplacian_json,dim=2,verbose=True)</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>to_markdown</code> function is used to display the results in a table.</td>
</tr>
</table>
</div>
<details class="result">
<summary class="title">Results</summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre>|    |      h |   P1-Norm_laplace_L2-error |   P1-Norm_laplace_H1-error |   P1-laplace_L2-convergence-rate |   P1-laplace_H1-convergence-rate |   P2-Norm_laplace_L2-error |   P2-Norm_laplace_H1-error |   P2-laplace_L2-convergence-rate |   P2-laplace_H1-convergence-rate |
|---:|-------:|---------------------------:|---------------------------:|---------------------------------:|---------------------------------:|---------------------------:|---------------------------:|---------------------------------:|---------------------------------:|
|  0 | 0.1    |                0.0256824   |                   0.957897 |                        nan       |                       nan        |                0.00108252  |                 0.0931597  |                        nan       |                        nan       |
|  1 | 0.05   |                0.00674339  |                   0.492079 |                          1.92924 |                         0.960981 |                0.000139537 |                 0.0240171  |                          2.95567 |                          1.95564 |
|  2 | 0.025  |                0.00170431  |                   0.247621 |                          1.98429 |                         0.990757 |                1.75159e-05 |                 0.00601782 |                          2.99391 |                          1.99675 |
|  3 | 0.0125 |                0.000426066 |                   0.123856 |                          2.00004 |                         0.999468 |                2.16968e-06 |                 0.00150015 |                          3.01311 |                          2.00414 |</pre>
</div>
</div>
</div>
</details>
<div class="paragraph">
<p>In 3D, we use the same code to verify the convergence rates of the error in \(L^2\) and \(H^1\) norms.
However we do this for different mesh sizes and only in \(\mathbb{P}^1\) to reduce the computational cost which increases significantly with the dimension.</p>
</div>
<div id="code:4" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">df3d=runConvergenceAnalysis(json=laplacian_json,dim=3,hs=[0.1,0.05,0.03],orders=[1],verbose=True)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Again, we observe that the proper convergence rates are obtained.</p>
</div>
<details class="result">
<summary class="title">Results</summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre>|    |    h |   P1-Norm_laplace_L2-error |   P1-Norm_laplace_H1-error |   P1-laplace_L2-convergence-rate |   P1-laplace_H1-convergence-rate |
|---:|-----:|---------------------------:|---------------------------:|---------------------------------:|---------------------------------:|
|  0 | 0.1  |                 0.060237   |                   1.53146  |                        nan       |                       nan        |
|  1 | 0.05 |                 0.0157572  |                   0.781105 |                          1.93464 |                         0.971323 |
|  2 | 0.03 |                 0.00531707 |                   0.452647 |                          2.12671 |                         1.06807  |</pre>
</div>
</div>
</div>
</details>
<div class="paragraph">
<p>Finally we postprocess the results using plotly.
The following code allows to</p>
</div>
<div class="ulist">
<ul>
<li>
<p>plot the error in \(L^2\) and \(H^1\) norms in plotly</p>
</li>
<li>
<p>display the convergence rates in the legend of the plot</p>
</li>
<li>
<p>check that the convergence rates are close to the theoretical values</p>
</li>
</ul>
</div>
<div id="code:5" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">import plotly.express as px
from plotly.subplots import make_subplots
import itertools

def plot_convergence(df,dim,orders=[1,2]):
    fig=px.line(df, x="h", y=[f'P{order}-Norm_laplace_{norm}-error' for order,norm in list(itertools.product(orders,['L2','H1']))])
    fig.update_xaxes(title_text="h",type="log")
    fig.update_yaxes(title_text="Error",type="log")
    for order,norm in list(itertools.product(orders,['L2','H1'])):
        fig.update_traces(name=f'P{order} - {norm} error - {df[f"P{order}-laplace_{norm}-convergence-rate"].iloc[-1]:.2f}', selector=dict(name=f'P{order}-Norm_laplace_{norm}-error'))
    fig.update_layout(
            title=f"Convergence rate for the {dim}D Laplacian problem",
            autosize=False,
            width=900,
            height=900,
        )
    fig.show()
plot_convergence(df,dim=2)
plot_convergence(df3d,dim=3,orders=[1])</code></pre>
</div>
</div>
<details class="result">
<summary class="title">Results</summary>
<div class="content">
<div class="paragraph">
<p><span class="image"><img src="../_images/pyfeelpp-toolboxes/cfpdes/cfpdes.poisson-1.png" alt="cfpdes.poisson 1" width="100%"></span></p>
</div>
</div>
</details>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_other_boundary_conditions"><a class="anchor" href="#_other_boundary_conditions"></a>3. Other boundary conditions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The previous example shows how to solve a Poisson problem with Dirichlet boundary conditions.</p>
</div>
<div class="sect2">
<h3 id="_inhomogeneous_dirichlet_boundary_conditions"><a class="anchor" href="#_inhomogeneous_dirichlet_boundary_conditions"></a>3.1. Inhomogeneous Dirichlet boundary conditions</h3>
<div class="paragraph">
<p>Given a function \(f \in L^2(\Omega)\) and a function \(g \in \mathcal{C}^{0,1}(\partial \Omega)\) ( \(g\) is lipschitzian on \(\partial \Omega\)), we look for a function \(u: \Omega \rightarrow \mathbb{R}\) such that</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{equation*}
\begin{aligned}
&amp; -\Delta u=f \text { in } \Omega \text {, } \\
&amp; u=g \quad \text { on } \partial \Omega . \\
&amp;
\end{aligned}
\end{equation*}\]
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>We can take \(g\) in the fractional Sobolev space \(H^{\frac{1}{2}}(\partial \Omega)\) defined as</p>
</div>
<div class="stemblock">
<div class="content">
\[H^{\frac{1}{2}}(\partial \Omega)=\left\{v \in L^2(\partial \Omega) ; \frac{v(x)-v(y)}{\|x-y\|^{\frac{d+1}{2}}} \in L^2(\partial \Omega \times \partial \Omega)\right\}.\]
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The hypothesis \(g \in \mathcal{C}^{0,1}(\partial \Omega)\) allows us to assert that there exists a lifting \(u_g\) of \(g\) in \(H^1(\Omega)\), that is to say that there exists a function \(u_g\) in \(H^1(\Omega)\) such that \(\left.u_g\right|_{\partial \Omega}=g\).</p>
</div>
<div class="paragraph">
<p>Under these conditions, we perform the change of unknown \(u_0=u-u_g\) and consider the following weak formulation:</p>
</div>
<div id="laplace-dir" class="stemblock">
<div class="content">
\[\begin{equation*}
\left\{\begin{array}{l}
\text { Find } u_0 \in H_0^1(\Omega) \text { such that } \\
a\left(u_0, w\right)=f(w)-a\left(u_g, w\right), \quad \forall w \in H_0^1(\Omega) .
\end{array}\right.
\end{equation*}\]
</div>
</div>
<div class="paragraph">
<p>By the Lax-Milgram lemma, this problem is well posed.
We are interested in a conformal approximation of <a href="#laplace-dir">the problem</a> by Lagrange finite elements.
We use the discrete framework described previously.
We suppose that the data \(g\) is regular enough to admit a lifting \(u_g\) in \(\mathcal{C}^0(\bar{\Omega}) \cap H^1(\Omega)\).
We denote \(\mathcal{I}_h^{\mathrm{Lag}}\) the interpolation operator associated with the mesh \(\mathcal{T}_h\) and the finite Lagrangian element of reference \(\widehat{K}, \widehat{P}, \widehat{\Sigma}}\).
Recall that \(P_{\mathrm{c}, h}^k\) denotes the \(H^1\)-conformal space based on this finite element and that \(V_h\) is the \(H_0^1\)-conformal approximation space defined in (5.9).</p>
</div>
<div class="paragraph">
<p>Let \(N=\operatorname{dim} P_{\mathrm{c}, h}^k\) be given.
We denote by \(\left\{\varphi_1, \ldots, \varphi_N\right\}\) the nodal basis of \(P_{\mathrm{c}, h}^k\) and by \(\left\{a_1, \ldots, a_N\right\}\) the associated nodes.
By definition, for \(u \in \mathcal{C}^0(\bar{\Omega})\), we have</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{equation*}
\mathcal{I}_h^{\mathrm{Lag}} u=\sum_{i=1}^N u\left(a_i\right) \varphi_i
\end{equation*}\]
</div>
</div>
<div class="paragraph">
<p>and we also introduce the surface Lagrange interpolation</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{equation*}
\mathcal{I}_h^{\mathrm{Lag} \partial}\left(\left.u\right|_{\partial \Omega}\right)=\left.\sum_{a_i \in \partial \Omega} u\left(a_i\right) \varphi_i\right|_{\partial \Omega}
\end{equation*}\]
</div>
</div>
<div class="paragraph">
<p>We consider the approximated problem</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{equation*}
\left\{\begin{array}{l}
\text { Find } u_{0 h} \in V_h \text { such that } \\
a\left(u_{0 h}, w_h\right)=f\left(w_h\right)-a\left(\mathcal{I}_h^{\mathrm{Lag}} u_g, w_h\right), \quad \forall w_h \in V_n,
\end{array}\right.
\end{equation*}\]
</div>
</div>
<div class="paragraph">
<p>which is clearly well posed.
We pose \(u_h=u_{0 h}+\mathcal{I}_h^{\mathrm{Lag}} u_g\) so that \(\left.u_h\right|_{partial \Omega}\) coincides with the Lagrange interpolated surface of \(g\).</p>
</div>
<div class="paragraph">
<p>\(u_h\) is the solution of the problem</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{equation*}
\left\{\begin{array}{l}
\text { Find } u_h \in P_{\mathrm{c}, h}^k \text { such that } \\
a\left(u_h, w_h\right)=f\left(w_h\right), \quad \forall w_h \in V_h, \
\left.u_h\right|_{\partial \Omega}=\mathcal{I}_h^{\mathrm{Lag}\, \partial} g .
\end{array}\right.
\end{equation*}\]
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
For any surface node \(x_i \in \partial \Omega\), then \(u_h\left(x_i\right)=g\left(x_i\right)\), but in general \(\left.u_h\right|_{\partial \Omega} \neq g\).
</td>
</tr>
</table>
</div>
<div id="thm:1:3" class="sidebarblock">
<div class="content">
<div class="title">Convergence theorem for the inhomogeneous Dirichlet problem</div>
<div class="paragraph">
<p>With the above assumptions, assume that the unique solution \(u\) of <a href="#laplace-dir">[laplace-dir]</a> is in \(H^{k+1}(\Omega) \cap H_0^1(\Omega)\).
Then there exists a constant \(c\) such that for all \(h\),</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{equation*}
\left\|u-u_h\right\|_{1, \Omega} \leq c h^k|u|_{k+1, \Omega} .
\end{equation*}\]
</div>
</div>
<div class="paragraph">
<p>Moreover, if <a href="#laplace-dir">the problem</a> is regularizing, there exists a constant \(\mathrm{c}\) such that for all \(h\),</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{equation*}
\left\|u-u_h\right\|_{0, \Omega} \leq c h^{k+1}|u|_{k+1, \Omega}
\end{equation*}\]
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_example"><a class="anchor" href="#_example"></a>3.1.1. Example</h4>
<div class="paragraph">
<p>Then we consider the \(\mathbb{R}^2\) domain \(\Omega\) defined by \(\Omega=\left\{x \in \mathbb{R}^2; 0 \leq x_1 \leq 1, 0 \leq x_2 \leq 1\right\}\).
We consider the following mesh \(\mathcal{T}_h\) of \(\Omega\) with \(h=0.1\).</p>
</div>
<div class="paragraph">
<p>We shall replace the exact solution by \(u(x,y)=\sin(2\pi x) \cos(2\pi y)\) which yields</p>
</div>
<div class="stemblock">
<div class="content">
\[f=\Delta u=4\pi^2 \sin(2\pi x) \cos(2\pi y).\]
</div>
</div>
<div class="paragraph">
<p>the boundary condition \(g=0\) is replace by \(h=u\) on \(\partial \Omega\).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python"># get the laplacian json model
def laplacian_g_json(dim,order=1):
    j=laplacian_json(dim=dim,order=order)
    if dim == 2:
        j['Models']['laplace']['setup']['coefficients']['f']=f'8*(pi^2)*sin(2*pi*x)*cos(2*pi*y):x:y'
        j['BoundaryConditions']['laplace']['Dirichlet']['g']={
                                                                "markers":["Gamma_D"],
                                                                "expr":"sin(2*pi*x)*cos(2*pi*y):x:y"
                                                             }
        j['PostProcess'][f'cfpdes-2d']['Measures']['Norm']['laplace']['solution']='sin(2*pi*x)*cos(2*pi*y):x:y'
        j['PostProcess'][f'cfpdes-2d']['Measures']['Norm']['laplace']['grad_solution']='{2*pi*cos(2*pi*x)*cos(2*pi*y),-2*pi*sin(2*pi*x)*sin(2*pi*y)}:x:y'
    else:
        j['Models']['laplace']['setup']['coefficients']['f']='12*(pi^2)*sin(2*pi*x)*cos(2*pi*y)*cos(2*pi*z):x:y:z'
        j['BoundaryConditions']['laplace']['Dirichlet']['g']={
                                                                "markers":["Gamma_D"],
                                                                "expr":"sin(2*pi*x)*cos(2*pi*y)*cos(2*pi*z):x:y:z"
                                                             }
        j['PostProcess'][f'cfpdes-3d']['Measures']['Norm']['laplace']['solution']='sin(2*pi*x)*cos(2*pi*y)*cos(2*pi*z):x:y:z'
        j['PostProcess'][f'cfpdes-3d']['Measures']['Norm']['laplace']['grad_solution']='{2*pi*cos(2*pi*x)*cos(2*pi*y)*cos(2*pi*z),-2*pi*sin(2*pi*x)*sin(2*pi*y)*cos(2*pi*z),-2*pi*sin(2*pi*x)*cos(2*pi*y)*sin(2*pi*z)}:x:y:z'
    return j

# in 2D
laplacian(hsize=0.1,json=laplacian_g_json(dim=2,order=1),dim=2)

# in 3D
laplacian(hsize=0.1,json=laplacian_g_json(dim=3,order=1),dim=3)</code></pre>
</div>
</div>
<div class="paragraph">
<p>We can then plot the 2D results</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python"># plot the 2D results
myplots(dim=2)</code></pre>
</div>
</div>
<div class="paragraph">
<p>and plot the 3D results</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python"># plot the 3D results
myplots(dim=3)</code></pre>
</div>
</div>
<div class="paragraph">
<p>We now run the convergence analysis and verify the convergence rate expected from <a href="#thm:1">Convergence theorem of the conforming approximation</a> in 2D.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python"># run the 2D convergence analysis
df=runConvergenceAnalysis(json=laplacian_g_json,dim=2,verbose=True)</code></pre>
</div>
</div>
<div class="paragraph">
<p>We now run the convergence analysis and verify the convergence rate expected from <a href="#thm:1">Convergence theorem of the conforming approximation</a> in 2D.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python"># run the 2D convergence analysis
df3d=runConvergenceAnalysis(json=laplacian_g_json,dim=3,hs=[0.1,0.05,0.03], orders=[1], verbose=True)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_neumann_boundary_conditions"><a class="anchor" href="#_neumann_boundary_conditions"></a>3.2. Neumann boundary conditions</h3>
<div class="paragraph">
<p>Given a strictly positive real \(\lambda\), a function \(f \in L^2(\Omega)\) and a function \(g \in L^2(\partial \Omega)\), we look for a function \(u: \Omega \rightarrow \mathbb{R}\) such that</p>
</div>
<div id="laplace-N" class="stemblock">
<div class="content">
\[\begin{equation*}
\begin{aligned}
&amp; -\Delta u+\lambda u=f \quad \text { in } \Omega \text {, } \\
&amp; \partial_n u=g \quad \operatorname{on} \partial \Omega \text {, } \\
&amp;
\end{aligned}
\end{equation*}\]
</div>
</div>
<div class="paragraph">
<p>where \(\partial_n u\) denotes the normal derivative of \(u\) on the boundar.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
By noting \(n=\left(n_1, \ldots, n_d\right)^T\) the Cartesian coordinates of the exterior normal at a point of the boundary, we have by definition \(\partial_n u=n \cdot \nabla u=\sum_{i=1}^d n_i \partial_i u\).
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The weak formulation of <a href="#laplace-N">the Neumann problem</a> reads</p>
</div>
<div id="laplace-N-vf" class="stemblock">
<div class="content">
\[\begin{equation*}
\left\{\begin{array}{l}
\text { Find } u \in H^1(\Omega) \text { such that } \\
a_{\mathrm{N}}(u, w)=f_{\mathrm{N}}(w), \quad \forall w \in H^1(\Omega),
\end{array}\right.
\end{equation*}\]
</div>
</div>
<div class="paragraph">
<p>where</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{equation*}
a_{\mathrm{N}}(v, w)=\int_{\Omega} \nabla v \cdot \nabla w+\int_{\Omega} \lambda v w
\end{equation*}\]
</div>
</div>
<div class="paragraph">
<p>and</p>
</div>
<div id="laplace-N-vf-fN" class="stemblock">
<div class="content">
\[\begin{equation*}
f_{\mathrm{N}}(w)=\int_{\Omega} f w+\int_{\partial \Omega} g w
\end{equation*}\]
</div>
</div>
<div class="paragraph">
<p>The well-posedness of <a href="#laplace-N-vf">the weak formulation</a> results from the coercivity of the bilinear form \(a_{\mathrm{N}} \operatorname{on} H^1(\Omega)\).
The <a href="#laplace-N-vf">problem</a> can be approximated by Lagrange finite elements.
We take the discrete framework described for the <a href="#_conforming_approximation">Conforming Approximation</a>.
We consider the following approximated problem:</p>
</div>
<div id="laplace-N-approx" class="stemblock">
<div class="content">
\[\begin{equation*}
\left\{\begin{array}{l}
\text { Find } u_h \in P_{\mathrm{c}, h}^k \text { such that } \\
a_{\mathrm{N}}\left(u_h, w_h\right)=f_{\mathrm{N}}\left(w_h\right), \quad \forall w_h \in P_{\mathrm{c}, h}^k,
\end{array}\right.
\end{equation*}\]
</div>
</div>
<div class="paragraph">
<p>which is clearly <strong>well-posed</strong>.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
An important difference between the Neumann boundary condition and the Dirichlet boundary condition is that the former is not imposed explicitly in the space where the solution is sought but results from the fact that the test functions in <a href="#laplace-N-vf">the variational formulation</a> can take zero values at the edge. This difference is reflected in the finite element approximation by the fact that the solution \(u_h\) of <a href="#laplace-N-approx">the discrete Neumann problem</a> satisfies the Neumann boundary condition in an approximate way and not in an exact way.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Finally, the convergence analysis of the  <a href="#laplace-N-approx">approximatio problem</a> leads, under the assumptions of <a href="#thm:1">Theorem</a>, to the same estimates as for the homogeneous Dirichlet problem.</p>
</div>
<div class="paragraph">
<p>We can also consider, at the cost of some technical difficulties, the Neumann problem with \(\lambda=0\).
We look for a function \(u: \Omega \rightarrow \mathbb{R}\) such that</p>
</div>
<div id="laplace-N-0" class="stemblock">
<div class="content">
\[\begin{equation*}
\begin{array}{rr}
-\Delta u=f &amp; \text { in } \Omega, \\
\partial_n u=g &amp; \text { on } \partial \Omega .
\end{array}
\end{equation*}\]
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="title">Necessary condition for the existence of a solution for the Neumann problem with \(\lambda=0\)</div>
<div class="paragraph">
<p>We observe that a necessary condition for the existence of a solution is that the data \(f\) and \(g\) satisfy the compatibility condition</p>
</div>
<div id="laplace-N-0-cond" class="stemblock">
<div class="content">
\[\begin{equation*}
\int_{\Omega} f+\int_{\partial \Omega} g=0
\end{equation*}\]
</div>
</div>
<div class="paragraph">
<p>since \(\int_{\Omega} f+\int_{\partial \Omega} g=-\int_{\Omega} \Delta u+\int_{\partial \Omega} \partial_n u=0\) according to the divergence theorem.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Divergence theorem</div>
<div class="paragraph">
<p>The divergence theorem expresses the fact that for any \(\phi\) vector field that is sufficiently regular,</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{equation*}
\int_{\Omega} \nabla \cdot \phi=\int_{\partial \Omega} \phi \cdot n
\end{equation*}\]
</div>
</div>
<div class="paragraph">
<p>In particular, taking \(\phi=\nabla u\) where \(u\) is a sufficiently regular function, we get \(\int_{\Omega} \Delta u=\int_{\partial \Omega} \partial_n u\).</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A solution of the <a href="#laplace-N-0">problem</a> with the <a href="#laplace-N-cond">condition</a>  is only determined to within one additive constant.
We should then look for the solution in the functional space</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{equation*}
H_*^1(\Omega)=\left\{v \in H^1(\Omega); \int_{\Omega} v=0\right\} .
\end{equation*}\]
</div>
</div>
<div class="paragraph">
<p>The weak formulation is the following:</p>
</div>
<div id="laplace-N-0-vf" class="stemblock">
<div class="content">
\[\begin{equation*}
\left\{\begin{array}{l}
\text { Find } u \in H_*^1(\Omega) \text { such that } \\
a(u, w)=f_{\mathrm{N}}(w), \quad \forall w \in H_*^1(\Omega),
\end{array}\right.
\end{equation*}\]
</div>
</div>
<div class="paragraph">
<p>with the bilinear form $a$ such that \(a(v, w)=\int_{\Omega} \nabla v \cdot \nabla w\).</p>
</div>
<div class="paragraph">
<p>The well-posedness of <a href="#laplace-N-0-vf">problem</a> results from the coercivity of the bilinear form a on \(H_*^1(\Omega)\), this last property being itself a consequence of the inequality below.</p>
</div>
<div id="lem:2" class="sidebarblock">
<div class="content">
<div class="title">Lemma: Poincaré-Wirtinger inequality.</div>
<div class="paragraph">
<p>Let \(\Omega\) be a bounded open of \(\mathbb{R}^d\).
There exists a constant \(\ell_{\Omega}^{\prime \prime}\) such that</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{equation*}
\forall v \in H_*^1(\Omega), \quad\|v\|_{0, \Omega} \leq \ell_{\Omega}^{\prime \prime} \|\nabla v\|_{0, \Omega}
\end{equation*}\]
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The <a href="#laplace-N-0-vf">problem</a>  can be approximated by Lagrangian finite elements, which leads to the following approximated problem:</p>
</div>
<div id="laplace-N-0-approx" class="stemblock">
<div class="content">
\[\begin{equation*}
\left\{\begin{array}{l}
\text { Find } u_h \in P_{\mathrm{c}, h}^k \text { such that } \\
a\left(u_h, w_h\right)=f_{\mathrm{N}}\left(w_h\right), \quad \forall w_h \in P_{\mathrm{c}, h}^k .
\end{array}\right.
\end{equation*}\]
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
the approximation space \(P_{\mathrm{c}, h}^k\) is not conformal in \(H_*^1(\Omega)\) and that the linear system associated to the <a href="#discrete problem">laplace-N-0-vf-approx</a> is singular.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>By noting this linear system in the form</p>
</div>
<div id="laplace-N-0-approx-sys" class="stemblock">
<div class="content">
\[\begin{equation*}
\mathcal{A}^* U=F^*
\end{equation*}\]
</div>
</div>
<div class="paragraph">
<p>and introducing the vector \(Z=(1, \ldots, 1)^T \in \mathbb{R}^N\) where \(N=\operatorname{dim} P_{\mathrm{c}, h}^k\), we find that \(\operatorname{Ker}\left(\mathcal{A}^*\right)=\operatorname{span}(Z), \operatorname{Im}\left(\mathcal{A}^*\right)=Z^{\perp}\) and \(F^* \in Z^{\perp}\).
Therefore, the <a href="#laplace-N-0-approx-sys">linear system</a>  has infinitely many solutions.
One of them can be approximated using an iterative method, for example the conjugate gradient method.
We denote by \(U^{\circ}\) the approximation provided by the iterative method.
The solution of the <a href="#laplace-N-0-approx-sys">linear system</a> whose components have zero mean is obtained by posing</p>
</div>
<div id="laplace-N-0-approx-sol" class="stemblock">
<div class="content">
\[\begin{equation*}
U=U^{\circ}-\left(\frac{\left(U^{\circ}, Z\right)_{\mathbb{R}^N}}{(Z, Z)_{\mathbb{R}^N}}\right) Z
\end{equation*}\]
</div>
</div>
<div class="paragraph">
<p>where \((\cdot, \cdot)_{\mathbb{R}^N}\) denotes the Euclidean scalar product on \(\mathbb{R}^N\).  \
The <a href="#laplace-N-0-approx-sol">postprocessing of the solution</a> removes the mean value of the solution \(U^{\circ}\) and is necessary to obtain the zero mean solution of <a href="#laplace-N-0-approx">problem</a>.</p>
</div>
<div class="paragraph">
<p>An alternative way to obtain the solution of <a href="#laplace-N-0-approx-sys">linear system</a> is to use the method of Lagrange multipliers to impose the condition \(\int_{\Omega} u=0\).</p>
</div>
<div class="sect3">
<h4 id="_example_2"><a class="anchor" href="#_example_2"></a>3.2.1. Example</h4>
<div class="paragraph">
<p>Consider the <a href="#laplace-N-0">problem</a> with \(\Omega=\mathbb{R}^2\) and the exact solution \(u(x, y)=\sin(2*\pi*x) \sin(2*\pi*y)\) in 2D and \(u(x, y, z)=\sin(2*\pi*x) \sin(2*\pi*y) \sin(2*\pi*z)\) in 3D.</p>
</div>
<div class="paragraph">
<p>The right hand side \(f\) and the boundary condition \(g_{\mathrm{N}}\) are computed using the exact solution \(u\) in \(\mathbb{R}^d, d=2,3\).
We have</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{equation*}
\begin{aligned}
f_{\mathrm{N}}(x, y)&amp;=- \Delta u(x,y) = 4  d  \pi^2 \sin(2 \pi x) \sin(2 \pi y)\\
g_{\mathrm{N}}(x, y)&amp;=\partial_n u(x,y) = 0
\end{aligned}
\end{equation*}\]
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
we can verify the condition <a href="#laplace-N-0-cond">[laplace-N-0-cond]</a> is indeed satisfied.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The code below computes the solution of the <a href="#laplace-N-0">problem</a> using the finite element method in 2D.</p>
</div>
<div id="code:laplace-N-0" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python"># get the laplacian json model
def laplacian_gN_json(dim,order=1):
    j=laplacian_json(dim=dim,order=order)
    if dim == 2:
        j['Models']['laplace']['setup']['coefficients']['f']=f'8*(pi^2)*sin(2*pi*x)*sin(2*pi*y)+sin(2*pi*x)*sin(2*pi*y):x:y'
        j['Models']['laplace']['setup']['coefficients']['a']='1' # set \lambda=1
        j['BoundaryConditions']['laplace'].pop('Dirichlet')
        j['BoundaryConditions']['laplace']['Neumann']= { "gN": {
                                                                "markers":["Gamma_D"],
                                                                "expr":"2*pi*cos(2*pi*x)*sin(2*pi*y)*nx+2*pi*sin(2*pi*x)*cos(2*pi*y)*ny:x:y:nx:ny"
                                                               }
                                                        }
        j['PostProcess'][f'cfpdes-2d']['Measures']['Norm']['laplace']['solution']='sin(2*pi*x)*sin(2*pi*y):x:y'
        j['PostProcess'][f'cfpdes-2d']['Measures']['Norm']['laplace']['grad_solution']='{2*pi*cos(2*pi*x)*sin(2*pi*y),2*pi*sin(2*pi*x)*cos(2*pi*y)}:x:y'
    return j

# in 2D
laplacian(hsize=0.1,json=laplacian_gN_json(dim=2,order=1),dim=2)</code></pre>
</div>
</div>
<div class="paragraph">
<p>We now run the convergence analysis and verify the convergence rate expected from <a href="#thm:1">Convergence theorem of the conforming approximation</a> in 2D.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python"># run the 2D convergence analysis
df=runConvergenceAnalysis(json=laplacian_gN_json,dim=2,verbose=True)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_robin_boundary_conditions"><a class="anchor" href="#_robin_boundary_conditions"></a>3.3. Robin Boundary Conditions</h3>
<div class="paragraph">
<p>Given a function \(f \in L^2(\Omega)\) and a function \(g \in L^2(\partial \Omega)\), we look for a function \(u: \Omega \rightarrow \mathbb{R}\) such that</p>
</div>
<div id="laplace-R-strong" class="stemblock">
<div class="content">
\[\begin{equation*}
\begin{aligned}
&amp; -\Delta u=f \quad \text { in } \Omega \text {, } \\
&amp; \gamma_R u+\partial_n u=g_R \quad \text { on } \partial \Omega, \
&amp;
\end{aligned}
\end{equation*}\]
</div>
</div>
<div class="paragraph">
<p>where \(\gamma_R&gt;0\) is a real parameter.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
More generally, consider a function \(\gamma_R \in L^{\infty}(\partial \Omega)\) such that \(\gamma_R(x) \geq \gamma_0&gt;0\) for almost all \(x \in \partial \Omega\).
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The weak formulation of the <a href="#laplace-R-strong">problem</a> reads</p>
</div>
<div id="laplace-R-weak" class="stemblock">
<div class="content">
\[\begin{equation*}
\left\{\begin{array}{l}
\text { Find } u \in H^1(\Omega) \text { such that } \\
a_{\mathrm{R}}(u, w)=f_{\mathrm{N}}(w), \quad \forall w \in H^1(\Omega),
\end{array}\right.
\end{equation*}\]
</div>
</div>
<div class="paragraph">
<p>where the linear form \(f_{\mathrm{N}}\) is defined <a href="#laplace-N-vf-fN">here</a> and the bilinear form \(a_{\mathrm{R}}\) is such that</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{equation*}
a_{\mathrm{R}}(v, w)=\int_{\Omega} \nabla v \cdot \nabla w+\int_{\partial \Omega} \gamma v w
\end{equation*}\]
</div>
</div>
<div class="paragraph">
<p>The well-posedness of <a href="#laplace-R-weak">weak problem</a> results from the coercivity of \(a_{mathrm{R}}[\) on \(H^1(\Omega)\), this last property being itself a consequence of the fact that there exists a constant \(\rho_{\Omega}\) such that</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{equation*}
\forall v \in H^1(\Omega), \quad\|v\|_{0, \Omega} \leq \rho_{\Omega} \left(\|nabla v|_{0, \Omega}+\|v\|_{0, \partial \Omega}\right) .
\end{equation*}\]
</div>
</div>
<div class="paragraph">
<p>Starting from the initial discrete framework, we are interested in an approximation  by Lagrange finite elements.
We consider the following approximated problem:</p>
</div>
<div id="laplace-R-vf-approx" class="stemblock">
<div class="content">
\[\begin{equation*}
\left\{\begin{array}{l}
\text { Find } u_h \in P_{mathrm{c}, h}^k \text { such that } \\
a_{\mathrm{R}}\left(u_h, w_h\right)=f_{\mathrm{N}}\left(w_h\right), \quad \forall w_h \in P_{\mathrm{c}, h}^k,
\end{array}\right.
\end{equation*}\]
</div>
</div>
<div class="paragraph">
<p>which is clearly well-posed.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
As with the Neumann boundary condition, the Robin boundary condition results from the fact that the test functions can take non-zero values at the edge; the condition is not exactly satisfied by the discrete solution \(u_h\) but only in an approximate way.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Finally, the convergence analysis for the \(u_h\)  leads, under the assumptions of &lt;&lt;thm:1,the theorem&gt;, to the same estimates as for the homogeneous Dirichlet problem.</p>
</div>
<div class="sect3">
<h4 id="_example_3"><a class="anchor" href="#_example_3"></a>3.3.1. Example</h4>
<div class="paragraph">
<p>We consider the following problem in the unit square \(\Omega=[0,1]^d, d=2\) with  exact solution \(u(x,y)=\sin(2\pi x)\, \sin(2\pi y)\). We consider \(\gamma_R=1\)
We then compute \(f\) and \(g_R\) such that \(u\) is the solution of the problem <a href="#laplace-R-strong">above</a>.</p>
</div>
<div class="paragraph">
<p>We have</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{equation*}
\begin{aligned}
f=-\Delta u &amp;=2 d \pi^2 sin(2\pi x)sin(2\pi y), \\
\nabla u = { 2\pi cos(2\pi x)sin(2\pi y), 2\pi sin(2\pi x)sin(2\pi y) } \\
g_R &amp;= +\gamma_R u+\nabla u \cdot n = \gamma_R sin(2\pi x)sin(2\pi y)+2\pi \cos(2\pi x)\sin(2\pi y) n_x +2\pi \sin(2\pi x) \cos(2\pi y) n_y.
\end{aligned}
\end{equation*}\]
</div>
</div>
<div class="paragraph">
<p>where \(n=(n_x,n_y)\) is the outward unit normal to the boundary \(\partial \Omega\).</p>
</div>
<div class="paragraph">
<p>The json specifications now read as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python"># get the laplacian json model
def laplacian_gR_json(dim,order=1):
    j=laplacian_json(dim=dim,order=order)
    if dim == 2:
        j['Parameters'] = { 'gammaR': 1.0 }
        j['BoundaryConditions']['laplace'].pop('Dirichlet')
        j['BoundaryConditions']['laplace']['Robin']= { "gR": {
                                                                "markers":["Gamma_D"],
                                                                "expr1":"gammaR:gammaR:x:y",
                                                                "expr2":"gammaR*sin(2*pi*x)*sin(2*pi*y)+(2*pi*cos(2*pi*x)*sin(2*pi*y)*nx+2*pi*sin(2*pi*x)*cos(2*pi*y)*ny):gammaR:x:y:nx:ny"
                                                             }
                                                        }
    return j

# in 2D
laplacian(hsize=0.1,json=laplacian_gR_json(dim=2,order=1),dim=2)</code></pre>
</div>
</div>
<div class="paragraph">
<p>We can now verify the convergence properties</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python"># run the 2D convergence analysis
df=runConvergenceAnalysis(json=laplacian_gR_json,dim=2,verbose=True)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_advection_diffusion_reaction_equation"><a class="anchor" href="#_advection_diffusion_reaction_equation"></a>3.4. Advection-Diffusion-Reaction Equation</h3>
<div class="paragraph">
<p>Consider a differential operator of the form
<a id="laplace-ADR-op"></a>]</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{equation*}
\mathcal{L} u=-\nabla \cdot(\sigma \cdot \nabla u)+\beta \cdot \nabla u+\mu u,
\end{equation*}\]
</div>
</div>
<div class="paragraph">
<p>where $\sigma, \beta$ and $\mu$ are functions defined on $\Omega$ and with values in $\mathbb{R}^{d, d}, \mathbb{R}^d$ and $\mathbb{R}$ respectively.
The <a href="#laplace-ADR-op">operator</a>  is used, for example, in the modeling of advection-diffusion-reaction problems; the first term of the right-hand side is the diffusive term, the second the advective term and the third the reactive term.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The advective term is sometimes called the "convective" term and the equation is then called the convection-diffusion-reaction equation.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The \(\mathcal{L}\) operator is used in many domais such as fluid mechanics, heat transfer, finance, chemistry, etc.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In the following, we assume that \(\sigma \in\left[L^{\infty}(\Omega)\right]^{d, d}, \beta \in\left[L^{\infty}(\Omega)\right]^d, \nabla \cdot \beta \in L^{\infty}(\Omega)\) and \(\mu \in L^{\infty}(\Omega)\).
Moreover, we assume that the operator \(\mathcal{L}\) is elliptic in the following sense.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Definition: Elliptic operator.</div>
<div class="paragraph">
<p>The <a href="#laplace-ADR-op">operator \(\mathcal{L}\)</a> is said to be <strong>elliptic</strong> if there exists a constant \(\sigma_0&gt;0\) such that, almost everywhere in \(\Omega\),</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{equation*}
\forall \xi \in \mathbb{R}^d, \quad \sum_{i, j=1}^d \sigma_{i j} \xi_i \xi_j \geq \sigma_0\left(\sum_{i=1}^d \xi_i^2\right) .
\end{equation*}\]
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The Laplacian falls into the category of elliptic operators since it is obtained from \(\mathcal{L}\) by taking \(\beta=0, \mu=0\) and \(\sigma=\mathcal{I}_d\), the identity matrix in \(\mathbb{R}^{d, d}\).
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="paragraph">
<p>Given a function \(f \in L^2(\Omega)\), we look for a function \(u: \Omega \rightarrow \mathbb{R}\) such that</p>
</div>
<div id="laplace-ADR-strong" class="stemblock">
<div class="content">
\[\begin{equation*}
\begin{aligned}
\mathcal{L} u &amp; =f &amp; &amp; \text { in } \Omega, \
u &amp; =0 &amp; &amp; \text { on } \partial \Omega .
\end{aligned}
\end{equation*}\]
</div>
</div>
<div class="paragraph">
<p>The weak formulation of the <a href="#laplace-ADR-strong">strong formulation</a> is the following:</p>
</div>
<div id="laplace-ADR-weak" class="stemblock">
<div class="content">
\[\begin{equation*}
\left\{\begin{array}{l}
\text { Find } u \in H_0^1(\Omega) \text { such that } \\
a_{\sigma \beta \mu}(u, w)=f(w), \quad \forall w \in H_0^1(\Omega),
\end{array}\right.
\end{equation*}\]
</div>
</div>
<div class="paragraph">
<p>with the bilinear form \(a_{\sigma \beta \mu}\) such that for all \((v, w) \in H_0^1(\Omega) \times H_0^1(\Omega)\),</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{equation*}
a_{\sigma \beta \mu}(v, w)=\int_{\Omega} \nabla w \cdot \sigma \cdot \nabla v+w(\beta \cdot \nabla v)+\mu w v
\end{equation*}\]
</div>
</div>
<div class="paragraph">
<p>We pose \(p=\inf {\operatorname{ess}}{ }_{x \in \Omega}\left(\mu-\frac{1}{2} \nabla \cdot \beta\right)\) and we recall that \(\ell_{\Omega}\) is the constant intervening in the Poincaré inequality above.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
For a function \(f \in L^{\infty}(\Omega), \inf \operatorname{ess}_{x \in \Omega} f(x)=\sup \left\{ M \in \mathbb{R}_{+}; f(x) \geq M \text{ almost\ everywhere\ in\ } \Omega\right\}\).
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Then, we show that under the condition</p>
</div>
<div id="laplace-ADR-condition" class="stemblock">
<div class="content">
\[\begin{equation*}
\sigma_0+\min \left(0, \ell_{\Omega} p\right)&gt;0
\end{equation*}\]
</div>
</div>
<div class="paragraph">
<p>the bilinear form \(a_{\sigma \beta \mu}\) is coercive on \(H_0^1(\Omega)\), so that, thanks to the Lax-Milgram lemma, the <a href="#laplace-ADR-weak">problem</a>  is well posed.
The <a href="#laplace-ADR-condition">condition</a>  being a minimization of \(\sigma_0\), we retain that the coercivity is guaranteed provided that \(\sigma_0\) is sufficiently large, i.e. in the <strong>dominant diffusion regime</strong>.</p>
</div>
<div class="paragraph">
<p>The conformal approximation  by Lagrangian finite elements uses the discrete framework introduced for the Laplacian.
Finally, one can consider instead of non-homogeneous Dirichlet, Neumann or Robin boundary conditions.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Convergence results are obtained in the same way as for the Laplacian, with the same assumptions on the mesh and the finite element space in the case of diffusion dominated problems, we shall see in <a href="#cfpdes.adr.adoc" class="xref unresolved">cfpdes.adr.adoc</a> that the mesh and finite element space must be adapted to the problem in the case of advection dominated problems.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_example_4"><a class="anchor" href="#_example_4"></a>3.4.1. Example</h4>
<div class="paragraph">
<p>we consider the same domain and exact solution as before and we set \(\beta=(1,1)\) and \(\mu=1\).</p>
</div>
<div class="paragraph">
<p>The json specifications now read as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python"># get the laplacian json model
def adr_json(dim,order=1,c=1):
    j=laplacian_json(dim=dim,order=order,name="u")
    if dim == 2:
        j['Models']['laplace']['setup']['coefficients']['f']='physics_laplace_laplace_c*8*(pi^2)*sin(2*pi*x)*sin(2*pi*y)+physics_laplace_laplace_beta_0*2*pi*cos(2*pi*x)*sin(2*pi*y)+physics_laplace_laplace_beta_1*2*pi*sin(2*pi*x)*cos(2*pi*y)+physics_laplace_laplace_a*sin(2*pi*x)*sin(2*pi*y):x:y:physics_laplace_laplace_beta_0:physics_laplace_laplace_beta_1:physics_laplace_laplace_c:physics_laplace_laplace_a'
        j['Models']['laplace']['setup']['coefficients']['beta']='{1,1}'
        j['Models']['laplace']['setup']['coefficients']['a']='1'
        j['Models']['laplace']['setup']['coefficients']['c']=c
    return j
print(adr_json(dim=2,order=1,c=1e-7))
# in 2D
laplacian(hsize=0.1,json=adr_json(dim=2,order=1,c=1),dim=2)</code></pre>
</div>
</div>
<details class="result">
<summary class="title">Results</summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre>{'Norm_laplace_H1-error': 1.1895228288020558,
 'Norm_laplace_L2-error': 0.021235807952695886}</pre>
</div>
</div>
</div>
</details>
<div class="paragraph">
<p>We can plot the solution:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">myplots(dim=2,field="cfpdes.laplace.u")</code></pre>
</div>
</div>
<div class="paragraph">
<p>and obtain the convergence rates as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python"># run the 2D convergence analysis with c=1
df=runConvergenceAnalysis(json=lambda dim,order: adr_json(dim=dim,order=order,c=1),dim=2,verbose=True)</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_references"><a class="anchor" href="#_references"></a>Appendix A: References</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>[1] docs.feelpp.org</p>
</li>
</ul>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="cfpdes.index.html">Coefficient Formulation PDEs</a></span>
  <span class="next"><a href="cfpdes.adr.html">Coefficient Formulation PDEs Advection Diffusion Equation  Equation</a></span>
</nav>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <div class="container">
    <div class="sharethis-inline-share-buttons"></div>
    <div class="footer-links">
      <div class="col">
        <div class="footer-logo">
          <a href="https://www.cemosis.fr" class="icon">
            <img src="../../../../_/img/logoCemosisTransparent.png" alt="Cemosis">
          </a>
        </div>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://docs.cemosis.fr" target="_blank" rel="noopener">Projects Documentation</a></li>
          <li><a href="https://join.slack.com/t/feelpp/shared_invite/zt-2qe0q9hw-4pVbhohCXUE6Po9Ma8dbiQ" target="_blank" rel="noopener">Forums(Slack)</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://www.cemosis.fr" target="_blank" rel="noopener">Cemosis</a></li>
          <li><a href="https://www.cemosis.fr/news" target="_blank" rel="noopener">News</a></li>
          <li><a href="https://www.cemosis.fr/projects" target="_blank" rel="noopener">Projects</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://docs.feelpp.org" target="_blank" rel="noopener">Feel++ Documentation</a></li>
          <li><a href="http://docs.feelpp.org/user/">Get Started</a></li>
          <li><a href="http://docs.feelpp.org/user//install/distributions/">Downloads</a></li>
        </ul>
      </div>
      <div class="col">
        <ul class="social-icons">
          <li>
            <svg  width="14" height="14" viewBox="0 0 32 32"> <path id="facebook" class="cls-1" d="M29,0H3A2.652,2.652,0,0,0,0,3V29a2.652,2.652,0,0,0,3,3H16V18H12V14h4V12a6.452,6.452,0,0,1,6-6h4v4H22a2.151,2.151,0,0,0-2,2v2h6l-1,4H20V32h9a2.652,2.652,0,0,0,3-3V3A2.652,2.652,0,0,0,29,0Z"/></svg>
            <a href="https://www.facebook.com/cemosis.fr" class="icon">
            Facebook
            </a>
          </li>
          <li>
            <svg  width="14" height="14" viewBox="0 0 32.1 26.1"> <path id="twitter" class="cls-1" d="M32,7.1a11.836,11.836,0,0,1-3.8,1,6.462,6.462,0,0,0,2.9-3.6,12.606,12.606,0,0,1-4.2,1.6A6.492,6.492,0,0,0,22.1,4a6.594,6.594,0,0,0-6.6,6.6,7.719,7.719,0,0,0,.2,1.5A18.458,18.458,0,0,1,2.2,5.2a6.294,6.294,0,0,0-.9,3.3A6.765,6.765,0,0,0,4.2,14a6.109,6.109,0,0,1-3-.8v.1a6.543,6.543,0,0,0,5.3,6.4,4.678,4.678,0,0,1-1.7.2,4.869,4.869,0,0,1-1.2-.1,6.679,6.679,0,0,0,6.1,4.6,12.917,12.917,0,0,1-8.2,2.8,9.151,9.151,0,0,1-1.6-.1,18.438,18.438,0,0,0,10.1,3c12.1,0,18.7-10,18.7-18.7v-.8A13.336,13.336,0,0,0,32,7.2Z" transform="translate(0.1 -4)"/></svg>
            <a href="https://twitter.com/cemosis" class="icon">
              Twitter
            </a>
          </li>
          <li>
          <svg  width="14" height="14" viewBox="0 0 32 32"> <path id="linkedin" class="cls-1" d="M29,0H3A3.076,3.076,0,0,0,0,3V29a3.009,3.009,0,0,0,3,3H29a2.946,2.946,0,0,0,3-3V3A3.009,3.009,0,0,0,29,0ZM12,26H8V12h4ZM10,10a2,2,0,1,1,2-2A2.006,2.006,0,0,1,10,10ZM26,26H22V18a2,2,0,0,0-4,0v8H14V12h4v2.5c.8-1.1,2.1-2.5,3.5-2.5A4.736,4.736,0,0,1,26,17Z"/></svg>
              <a href="https://www.linkedin.com/company/cemosis" class="icon">
             Linkedin
            </a>
          </li>
        </ul>
      </div>
    </div>
    <div class="footer-terms">
      <div class="footer-terms-copyright">
          <span>© 2023 Cemosis, Université de Strasbourg</span>
      </div>
      <div class="footer-terms-links">
        <a href="https://www.cemosis.fr/terms-of-use">Terms of Use</a>
        <a href="https://www.cemosis.fr/privacy-policy">Privacy Policy</a>
        <a href="https://www.cemosis.fr/cookie-policy">Cookie Policy</a>
        <a href="https://www.cemosis.fr/support-policy">Support Policy</a>
      </div>
    </div>
  </div>
</footer>
<script id="site-script" src="../../../../_/js/site.js" data-ui-root-path="../../../../_"></script>


<script async src="../../../../_/js/vendor/fontawesome-icon-defs.js"></script>
<script async src="../../../../_/js/vendor/fontawesome.js"></script>
<script async src="../../../../_/js/vendor/highlight.js"></script>

<script async id="search-script" src="../../../../_/js/vendor/docsearch.js" data-app-id="03CF2L5SFL" data-api-key="53f606259c1ee7b82a42956e0c776c3d" data-index-name="feelpp" data-stylesheet="../../../../_/css/vendor/docsearch.css">
</script>

<script type="text/javascript">
function toggleFullScreen() {
   var doc = window.document;
   var docEl = doc.documentElement;

   var requestFullScreen = docEl.requestFullscreen || docEl.mozRequestFullScreen || docEl.webkitRequestFullScreen || docEl.msRequestFullscreen;
   var cancelFullScreen = doc.exitFullscreen || doc.mozCancelFullScreen || doc.webkitExitFullscreen || doc.msExitFullscreen;

   if(!doc.fullscreenElement && !doc.mozFullScreenElement && !doc.webkitFullscreenElement && !doc.msFullscreenElement) {
       requestFullScreen.call(docEl);
   }
   else {
       cancelFullScreen.call(doc);
   }
}
</script>
  </body>
</html>
